[
{
  "model": "desktop.document2",
  "pk": 115654,
  "fields": {
    "owner": [
      "tsevero"
    ],
    "name": "CANCEL: 1 CNPJ",
    "description": "",
    "uuid": "7445ee15-33e6-d1f7-8f1b-4bd1f56bc85b",
    "type": "query-impala",
    "connector": null,
    "data": "{\"id\": 115654, \"uuid\": \"8b1c00f9-7c6c-4f2e-a4be-5cccf5a78598\", \"name\": \"CANCEL: 1 CNPJ\", \"description\": \"\", \"type\": \"query-impala\", \"initialType\": \"impala\", \"coordinatorUuid\": null, \"isHistory\": false, \"isManaged\": false, \"parentSavedQueryUuid\": \"7445ee15-33e6-d1f7-8f1b-4bd1f56bc85b\", \"isSaved\": true, \"onSuccessUrl\": null, \"pubSubUrl\": null, \"isPresentationModeDefault\": false, \"isPresentationMode\": false, \"isPresentationModeInitialized\": true, \"presentationSnippets\": {}, \"isHidingCode\": false, \"snippets\": [{\"id\": \"878a97c8-7a9e-d07a-7625-d224795cec37\", \"name\": \"\", \"type\": \"impala\", \"connector\": {\"name\": \"Impala\", \"type\": \"impala\", \"id\": \"impala\", \"displayName\": \"Impala\", \"buttonName\": \"Consulta\", \"tooltip\": \"Impala Query\", \"optimizer\": \"off\", \"page\": \"/editor/?type=impala\", \"is_sql\": true, \"is_batchable\": true, \"dialect\": \"impala\", \"dialect_properties\": {}}, \"isSqlDialect\": true, \"dialect\": \"impala\", \"isBatchable\": true, \"autocompleteSettings\": {\"temporaryOnly\": false}, \"aceCursorPosition\": {\"row\": 8, \"column\": 32}, \"errors\": [], \"aceErrorsHolder\": [], \"aceWarningsHolder\": [], \"aceErrors\": [], \"aceWarnings\": [], \"editorMode\": true, \"dbSelectionVisible\": false, \"showExecutionAnalysis\": true, \"namespace\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"status\": \"CREATED\", \"computes\": [{\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"type\": \"direct\", \"credentials\": {}}]}, \"compute\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"namespace\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"interface\": \"impala\", \"type\": \"direct\", \"options\": {}}, \"database\": \"bcadastro\", \"currentQueryTab\": \"queryResults\", \"pinnedContextTabs\": [], \"loadingQueries\": false, \"queriesHasErrors\": false, \"queriesCurrentPage\": 1, \"queriesTotalPages\": 1, \"queriesFilter\": \"\", \"queriesFilterVisible\": false, \"statementType\": \"text\", \"statementTypes\": [\"text\", \"file\"], \"statementPath\": \"\", \"externalStatementLoaded\": false, \"associatedDocumentLoading\": true, \"associatedDocumentUuid\": null, \"statement_raw\": \"-- Remover a tabela se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_cnpj;\\r\\n\\r\\n-- Criar nova tabela de CNPJs a partir da vw_cad_contrib com apenas valores \\u00fanicos\\r\\nCREATE TABLE teste.cancel_cnpj AS\\r\\nSELECT \\r\\n    DISTINCT nu_cnpj AS cnpj\\r\\nFROM usr_sat_ods.vw_cad_contrib;\", \"statementsList\": [\"-- Remover a tabela se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_cnpj;\", \"\\r\\n\\r\\n-- Criar nova tabela de CNPJs a partir da vw_cad_contrib com apenas valores \\u00fanicos\\r\\nCREATE TABLE teste.cancel_cnpj AS\\r\\nSELECT \\r\\n    DISTINCT nu_cnpj AS cnpj\\r\\nFROM usr_sat_ods.vw_cad_contrib;\"], \"aceSize\": 100, \"status\": \"available\", \"statusForButtons\": \"executed\", \"properties\": {\"settings\": []}, \"viewSettings\": {\"placeHolder\": \"Exemplo: SELECT * FROM tablename ou pressione CTRL + espa\\u00e7o\", \"sqlDialect\": true}, \"variables\": [], \"hasCurlyBracketParameters\": true, \"variableNames\": [], \"variableValues\": {}, \"statement\": \"-- Remover a tabela se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_cnpj;\\r\\n\\r\\n-- Criar nova tabela de CNPJs a partir da vw_cad_contrib com apenas valores \\u00fanicos\\r\\nCREATE TABLE teste.cancel_cnpj AS\\r\\nSELECT \\r\\n    DISTINCT nu_cnpj AS cnpj\\r\\nFROM usr_sat_ods.vw_cad_contrib;\", \"result\": {\"id\": \"20c485a0-2772-7a07-053a-3e4c16d3304f\", \"type\": \"table\", \"hasResultset\": true, \"handle\": {\"secret\": \"aZze3cJWTpuAL4u06/eikg==\", \"guid\": \"ssk4+OGsRh8AAAAAW8ijRQ==\", \"operation_type\": 0, \"has_result_set\": true, \"modified_row_count\": null, \"log_context\": null, \"session_guid\": \"984b6f311745cffa:2ddd378c7babe5a5\", \"session_id\": 14429, \"session_type\": \"impala\", \"statement_id\": 1, \"has_more_statements\": false, \"statements_count\": 2, \"previous_statement_hash\": \"dc1d39ff6cdeb530f7c7df642d713f9a0f4358594f54f003ad32ae6b\", \"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 7, \"column\": 31}, \"statement\": \"-- Criar nova tabela de CNPJs a partir da vw_cad_contrib com apenas valores \\u00fanicos\\nCREATE TABLE teste.cancel_cnpj AS\\nSELECT \\n    DISTINCT nu_cnpj AS cnpj\\nFROM usr_sat_ods.vw_cad_contrib\"}, \"meta\": [], \"rows\": \"1\", \"hasMore\": false, \"statement_id\": 1, \"statement_range\": {\"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 7, \"column\": 31}}, \"statements_count\": 2, \"metaFilter\": {\"query\": \"\", \"facets\": {}, \"text\": []}, \"isMetaFilterVisible\": false, \"filteredMetaChecked\": true, \"filteredColumnCount\": 1, \"filteredMeta\": [{\"type\": \"int\", \"name\": \"\", \"comment\": null, \"cssClass\": \"sort-numeric\", \"checked\": true, \"originalIndex\": 0}, {\"name\": \"summary\", \"type\": \"string\", \"comment\": null, \"cssClass\": \"sort-string\", \"checked\": true, \"originalIndex\": 1}], \"fetchedOnce\": false, \"startTime\": \"2025-04-10T18:24:37.484Z\", \"endTime\": \"2025-04-10T18:24:41.165Z\", \"executionTime\": 3681, \"data\": [], \"explanation\": \"\", \"logs\": \"\", \"logLines\": 6, \"hasSomeResults\": true}, \"showGrid\": true, \"showChart\": false, \"showLogs\": true, \"progress\": 0, \"jobs\": [], \"executeNextTimeout\": 6483, \"isLoading\": false, \"resultsKlass\": \"results impala\", \"errorsKlass\": \"results impala alert alert-error\", \"is_redacted\": false, \"chartType\": \"bars\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartLimits\": [5, 10, 25, 50, 100], \"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartYMulti\": [], \"chartData\": [], \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"hideStacked\": true, \"hasDataForChart\": false, \"previousChartOptions\": {\"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"chartYMulti\": [], \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null}, \"isResultSettingsVisible\": false, \"settingsVisible\": false, \"checkStatusTimeout\": 6766, \"getLogsTimeout\": 6862, \"topRisk\": null, \"suggestion\": \"\", \"hasSuggestion\": null, \"compatibilityCheckRunning\": false, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"compatibilitySourcePlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"compatibilityTargetPlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"showSqlAnalyzer\": false, \"wasBatchExecuted\": false, \"isReady\": true, \"lastExecuted\": 1744309477233, \"lastAceSelectionRowOffset\": 0, \"executingBlockingOperation\": null, \"showLongOperationWarning\": false, \"lastExecutedStatements\": \"-- Remover a tabela se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_cnpj;\\r\\n\\r\\n-- Criar nova tabela de CNPJs a partir da vw_cad_contrib com apenas valores \\u00fanicos\\r\\nCREATE TABLE teste.cancel_cnpj AS\\r\\nSELECT \\r\\n    DISTINCT nu_cnpj AS cnpj\\r\\nFROM usr_sat_ods.vw_cad_contrib;\", \"lastExecutedSelectionRange\": {\"start\": {\"row\": 0, \"column\": 0}, \"end\": {\"row\": 7, \"column\": 32}}, \"formatEnabled\": true, \"isFetchingData\": false, \"isCanceling\": false, \"aceAutoExpand\": false, \"lastCheckStatusRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"query_status\\\": {\\\"status\\\": \\\"available\\\"}}\", \"responseJSON\": {\"status\": 0, \"query_status\": {\"status\": \"available\"}}, \"status\": 200, \"statusText\": \"OK\"}, \"lastGetLogsRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"logs\\\": \\\"Query 1f46ace1f838c9b2:45a3c85b00000000 100% Complete (4 out of 4)\\\", \\\"progress\\\": 100, \\\"jobs\\\": [{\\\"name\\\": \\\"1f46ace1f838c9b2:45a3c85b00000000\\\", \\\"url\\\": \\\"/hue/jobbrowser#!id=1f46ace1f838c9b2:45a3c85b00000000\\\", \\\"started\\\": true, \\\"finished\\\": false, \\\"percentJob\\\": 100}], \\\"isFullLogs\\\": false}\", \"responseJSON\": {\"status\": 0, \"logs\": \"Query 1f46ace1f838c9b2:45a3c85b00000000 100% Complete (4 out of 4)\", \"progress\": 100, \"jobs\": [{\"name\": \"1f46ace1f838c9b2:45a3c85b00000000\", \"url\": \"/hue/jobbrowser#!id=1f46ace1f838c9b2:45a3c85b00000000\", \"started\": true, \"finished\": false, \"percentJob\": 100}], \"isFullLogs\": false}, \"status\": 200, \"statusText\": \"OK\"}}], \"selectedSnippet\": \"impala\", \"creatingSessionLocks\": [], \"sessions\": [], \"directoryUuid\": \"\", \"dependentsCoordinator\": [], \"historyFilter\": \"\", \"historyFilterVisible\": false, \"loadingHistory\": false, \"historyInitialHeight\": 17677, \"forceHistoryInitialHeight\": false, \"historyCurrentPage\": 1, \"historyTotalPages\": 27, \"schedulerViewModel\": null, \"schedulerViewModelIsLoaded\": false, \"isBatchable\": true, \"isExecutingAll\": false, \"executingAllIndex\": 0, \"retryModalConfirm\": null, \"retryModalCancel\": null, \"canSave\": true, \"unloaded\": false, \"updateHistoryFailed\": false, \"viewSchedulerId\": \"\", \"loadingScheduler\": false}",
    "extra": "",
    "search": "-- Remover a tabela se existir\r\nDROP TABLE IF EXISTS teste.cancel_cnpj;\r\n\r\n-- Criar nova tabela de CNPJs a partir da vw_cad_contrib com apenas valores Ãºnicos\r\nCREATE TABLE teste.cancel_cnpj AS\r\nSELECT \r\n    DISTINCT nu_cnpj AS cnpj\r\nFROM usr_sat_ods.vw_cad_contrib;",
    "last_modified": "2025-04-10T15:24:47.484",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "4021901f-ed7a-4fd2-b5bf-8647d6b477af",
      1,
      false
    ],
    "dependencies": []
  }
},
{
  "model": "desktop.document2",
  "pk": 115661,
  "fields": {
    "owner": [
      "tsevero"
    ],
    "name": "CANCEL: 2 CADASTRO",
    "description": "",
    "uuid": "93380a71-4304-d628-0644-aed61b6b5206",
    "type": "query-impala",
    "connector": null,
    "data": "{\"id\": 115661, \"uuid\": \"93380a71-4304-d628-0644-aed61b6b5206\", \"name\": \"CANCEL: 2 CADASTRO\", \"description\": \"\", \"type\": \"query-impala\", \"initialType\": \"impala\", \"coordinatorUuid\": null, \"isHistory\": false, \"isManaged\": false, \"parentSavedQueryUuid\": \"93380a71-4304-d628-0644-aed61b6b5206\", \"isSaved\": true, \"onSuccessUrl\": null, \"pubSubUrl\": null, \"isPresentationModeDefault\": false, \"isPresentationMode\": false, \"isPresentationModeInitialized\": true, \"presentationSnippets\": {}, \"isHidingCode\": false, \"snippets\": [{\"id\": \"29034cb6-3d2c-cb27-833c-69a7d46b29ec\", \"name\": \"\", \"type\": \"impala\", \"connector\": {\"name\": \"Impala\", \"type\": \"impala\", \"id\": \"impala\", \"displayName\": \"Impala\", \"buttonName\": \"Consulta\", \"tooltip\": \"Impala Query\", \"optimizer\": \"off\", \"page\": \"/editor/?type=impala\", \"is_sql\": true, \"is_batchable\": true, \"dialect\": \"impala\", \"dialect_properties\": {}}, \"isSqlDialect\": true, \"dialect\": \"impala\", \"isBatchable\": true, \"autocompleteSettings\": {\"temporaryOnly\": false}, \"aceCursorPosition\": {\"row\": 18, \"column\": 0}, \"errors\": [], \"aceErrorsHolder\": [], \"aceWarningsHolder\": [], \"aceErrors\": [], \"aceWarnings\": [], \"editorMode\": true, \"dbSelectionVisible\": false, \"showExecutionAnalysis\": false, \"namespace\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"status\": \"CREATED\", \"computes\": [{\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"type\": \"direct\", \"credentials\": {}}]}, \"compute\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"namespace\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"interface\": \"impala\", \"type\": \"direct\", \"options\": {}}, \"database\": \"bcadastro\", \"currentQueryTab\": \"savedQueries\", \"pinnedContextTabs\": [], \"loadingQueries\": false, \"queriesHasErrors\": false, \"queriesCurrentPage\": 1, \"queriesTotalPages\": 1, \"queriesFilter\": \"\", \"queriesFilterVisible\": false, \"statementType\": \"text\", \"statementTypes\": [\"text\", \"file\"], \"statementPath\": \"\", \"externalStatementLoaded\": false, \"associatedDocumentLoading\": true, \"associatedDocumentUuid\": null, \"statement_raw\": \"--SELECT \\r\\n--    nu_cnpj AS cnpj,\\r\\n--    nm_razao_social,\\r\\n--    nm_fantasia,\\r\\n--    cd_sit_cadastral,\\r\\n--    nm_sit_cadastral,\\r\\n--    cd_reg_apuracao,\\r\\n--    nm_reg_apuracao,\\r\\n--    sn_suspensao_dfe,\\r\\n--    dt_suspensao_dfe,\\r\\n--    tx_detalhe_suspensao_dfe,\\r\\n--    sn_simples_nacional_rfb,\\r\\n--    cd_cnae,\\r\\n--    cd_cnae1,\\r\\n--    cd_cnae2,\\r\\n--    cd_cnae3,\\r\\n--    tx_outras_cnaes\\r\\n--FROM \\r\\n--    teste.cancel_cadastro\\r\\n\\r\\n-- Remover a tabela se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_cadastro;\\r\\n\\r\\n-- Criar a nova tabela\\r\\nCREATE TABLE teste.cancel_cadastro AS\\r\\nSELECT \\r\\n    -- Colunas do contribuinte\\r\\n    contrib.nu_cnpj,\\r\\n    contrib.nu_cnpj_grupo,\\r\\n    contrib.nu_ie,\\r\\n    contrib.cd_usefi,\\r\\n    contrib.nm_usefi,\\r\\n    contrib.cd_gerfe,\\r\\n    contrib.nm_gerfe,\\r\\n    contrib.dt_inclusao_cad,\\r\\n    contrib.dt_ult_atualiz,\\r\\n    contrib.dt_constituicao_empresa,\\r\\n    contrib.nm_razao_social,\\r\\n    contrib.nm_fantasia,\\r\\n    contrib.cd_sit_cadastral,\\r\\n    contrib.nm_sit_cadastral,\\r\\n    contrib.dt_sit_cadastral,\\r\\n    contrib.cd_natureza_juridica,\\r\\n    contrib.nm_natureza_juridica,\\r\\n    contrib.dt_inicio_icms,\\r\\n    contrib.cd_cnae,\\r\\n    contrib.de_cnae,\\r\\n    contrib.cd_secao,\\r\\n    contrib.de_secao,\\r\\n    contrib.cd_divisao,\\r\\n    contrib.de_divisao,\\r\\n    contrib.cd_grupo,\\r\\n    contrib.de_grupo,\\r\\n    contrib.cd_classe,\\r\\n    contrib.de_classe,\\r\\n    contrib.qt_cnae_sec,\\r\\n    contrib.cd_cnae1,\\r\\n    contrib.nm_cnae1,\\r\\n    contrib.cd_cnae2,\\r\\n    contrib.nm_cnae2,\\r\\n    contrib.cd_cnae3,\\r\\n    contrib.nm_cnae3,\\r\\n    contrib.tx_outras_cnaes,\\r\\n    contrib.tx_lista_cnae_sec,\\r\\n    contrib.cd_reg_apuracao,\\r\\n    contrib.nm_reg_apuracao,\\r\\n    contrib.cd_enq_empresa,\\r\\n    contrib.nm_enq_empresa,\\r\\n    contrib.sn_apur_consolidada,\\r\\n    contrib.sn_estab_consolidado,\\r\\n    contrib.sn_estab_consolidador,\\r\\n    contrib.sn_matriz,\\r\\n    contrib.nu_ie_consolidador,\\r\\n    contrib.cd_ges,\\r\\n    contrib.nm_ges,\\r\\n    contrib.cd_munic,\\r\\n    contrib.nm_munic,\\r\\n    contrib.cd_uf,\\r\\n    contrib.nm_logradouro,\\r\\n    contrib.nu_logradouro,\\r\\n    contrib.tx_complemento,\\r\\n    contrib.tx_referencia,\\r\\n    contrib.nm_bairro,\\r\\n    contrib.cd_cep,\\r\\n    contrib.nu_telefone,\\r\\n    contrib.nm_email,\\r\\n    contrib.nu_cpf_cnpj_contador,\\r\\n    contrib.nm_contador,\\r\\n    contrib.nu_crc_contador,\\r\\n    contrib.nu_telefone_contador,\\r\\n    contrib.nm_email_contador,\\r\\n    contrib.dt_ini_relac_contador,\\r\\n    contrib.cd_munic_contador,\\r\\n    contrib.nm_munic_contador,\\r\\n    contrib.cd_uf_contador,\\r\\n    contrib.nm_logradouro_contador,\\r\\n    contrib.nu_logradouro_contador,\\r\\n    contrib.nm_bairro_contador,\\r\\n    contrib.cd_cep_contador,\\r\\n    contrib.dt_inclusao_ods,\\r\\n    contrib.dt_ult_atualiz_ods,\\r\\n    contrib.id_seq_ult_alt,\\r\\n    contrib.nu_ie_rge_ruc,\\r\\n    contrib.qt_vinculos,\\r\\n    contrib.qt_vinculos_ativos,\\r\\n    contrib.qt_socios,\\r\\n    contrib.qt_socios_ativos,\\r\\n    contrib.qt_adm,\\r\\n    contrib.qt_adm_ativos,\\r\\n    contrib.qt_repres,\\r\\n    contrib.qt_repres_ativos,\\r\\n    contrib.qt_contab,\\r\\n    contrib.qt_contab_ativos,\\r\\n    contrib.qt_pessoas_vinc,\\r\\n    contrib.qt_pessoas_vinc_ativos,\\r\\n    contrib.cd_tipo_contribuinte,\\r\\n    contrib.nm_tipo_contribuinte,\\r\\n    contrib.sn_suspensao_dfe,\\r\\n    contrib.dt_suspensao_dfe,\\r\\n    contrib.tx_detalhe_suspensao_dfe,\\r\\n    contrib.dt_alteracao,\\r\\n    contrib.sn_dtec,\\r\\n    contrib.dt_credenciamento_dtec,\\r\\n    contrib.sn_simples_nacional_rfb,\\r\\n    \\r\\n    -- Colunas da tabela cancel_cnpj\\r\\n    cancel.cnpj\\r\\n    --cancel.malhas\\r\\nFROM teste.cancel_cnpj cancel\\r\\nJOIN usr_sat_ods.vw_cad_contrib contrib\\r\\n    ON cancel.cnpj = contrib.nu_cnpj;\", \"statementsList\": [\"--SELECT \\r\\n--    nu_cnpj AS cnpj,\\r\\n--    nm_razao_social,\\r\\n--    nm_fantasia,\\r\\n--    cd_sit_cadastral,\\r\\n--    nm_sit_cadastral,\\r\\n--    cd_reg_apuracao,\\r\\n--    nm_reg_apuracao,\\r\\n--    sn_suspensao_dfe,\\r\\n--    dt_suspensao_dfe,\\r\\n--    tx_detalhe_suspensao_dfe,\\r\\n--    sn_simples_nacional_rfb,\\r\\n--    cd_cnae,\\r\\n--    cd_cnae1,\\r\\n--    cd_cnae2,\\r\\n--    cd_cnae3,\\r\\n--    tx_outras_cnaes\\r\\n--FROM \\r\\n--    teste.cancel_cadastro\\r\\n\\r\\n-- Remover a tabela se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_cadastro;\", \"\\r\\n\\r\\n-- Criar a nova tabela\\r\\nCREATE TABLE teste.cancel_cadastro AS\\r\\nSELECT \\r\\n    -- Colunas do contribuinte\\r\\n    contrib.nu_cnpj,\\r\\n    contrib.nu_cnpj_grupo,\\r\\n    contrib.nu_ie,\\r\\n    contrib.cd_usefi,\\r\\n    contrib.nm_usefi,\\r\\n    contrib.cd_gerfe,\\r\\n    contrib.nm_gerfe,\\r\\n    contrib.dt_inclusao_cad,\\r\\n    contrib.dt_ult_atualiz,\\r\\n    contrib.dt_constituicao_empresa,\\r\\n    contrib.nm_razao_social,\\r\\n    contrib.nm_fantasia,\\r\\n    contrib.cd_sit_cadastral,\\r\\n    contrib.nm_sit_cadastral,\\r\\n    contrib.dt_sit_cadastral,\\r\\n    contrib.cd_natureza_juridica,\\r\\n    contrib.nm_natureza_juridica,\\r\\n    contrib.dt_inicio_icms,\\r\\n    contrib.cd_cnae,\\r\\n    contrib.de_cnae,\\r\\n    contrib.cd_secao,\\r\\n    contrib.de_secao,\\r\\n    contrib.cd_divisao,\\r\\n    contrib.de_divisao,\\r\\n    contrib.cd_grupo,\\r\\n    contrib.de_grupo,\\r\\n    contrib.cd_classe,\\r\\n    contrib.de_classe,\\r\\n    contrib.qt_cnae_sec,\\r\\n    contrib.cd_cnae1,\\r\\n    contrib.nm_cnae1,\\r\\n    contrib.cd_cnae2,\\r\\n    contrib.nm_cnae2,\\r\\n    contrib.cd_cnae3,\\r\\n    contrib.nm_cnae3,\\r\\n    contrib.tx_outras_cnaes,\\r\\n    contrib.tx_lista_cnae_sec,\\r\\n    contrib.cd_reg_apuracao,\\r\\n    contrib.nm_reg_apuracao,\\r\\n    contrib.cd_enq_empresa,\\r\\n    contrib.nm_enq_empresa,\\r\\n    contrib.sn_apur_consolidada,\\r\\n    contrib.sn_estab_consolidado,\\r\\n    contrib.sn_estab_consolidador,\\r\\n    contrib.sn_matriz,\\r\\n    contrib.nu_ie_consolidador,\\r\\n    contrib.cd_ges,\\r\\n    contrib.nm_ges,\\r\\n    contrib.cd_munic,\\r\\n    contrib.nm_munic,\\r\\n    contrib.cd_uf,\\r\\n    contrib.nm_logradouro,\\r\\n    contrib.nu_logradouro,\\r\\n    contrib.tx_complemento,\\r\\n    contrib.tx_referencia,\\r\\n    contrib.nm_bairro,\\r\\n    contrib.cd_cep,\\r\\n    contrib.nu_telefone,\\r\\n    contrib.nm_email,\\r\\n    contrib.nu_cpf_cnpj_contador,\\r\\n    contrib.nm_contador,\\r\\n    contrib.nu_crc_contador,\\r\\n    contrib.nu_telefone_contador,\\r\\n    contrib.nm_email_contador,\\r\\n    contrib.dt_ini_relac_contador,\\r\\n    contrib.cd_munic_contador,\\r\\n    contrib.nm_munic_contador,\\r\\n    contrib.cd_uf_contador,\\r\\n    contrib.nm_logradouro_contador,\\r\\n    contrib.nu_logradouro_contador,\\r\\n    contrib.nm_bairro_contador,\\r\\n    contrib.cd_cep_contador,\\r\\n    contrib.dt_inclusao_ods,\\r\\n    contrib.dt_ult_atualiz_ods,\\r\\n    contrib.id_seq_ult_alt,\\r\\n    contrib.nu_ie_rge_ruc,\\r\\n    contrib.qt_vinculos,\\r\\n    contrib.qt_vinculos_ativos,\\r\\n    contrib.qt_socios,\\r\\n    contrib.qt_socios_ativos,\\r\\n    contrib.qt_adm,\\r\\n    contrib.qt_adm_ativos,\\r\\n    contrib.qt_repres,\\r\\n    contrib.qt_repres_ativos,\\r\\n    contrib.qt_contab,\\r\\n    contrib.qt_contab_ativos,\\r\\n    contrib.qt_pessoas_vinc,\\r\\n    contrib.qt_pessoas_vinc_ativos,\\r\\n    contrib.cd_tipo_contribuinte,\\r\\n    contrib.nm_tipo_contribuinte,\\r\\n    contrib.sn_suspensao_dfe,\\r\\n    contrib.dt_suspensao_dfe,\\r\\n    contrib.tx_detalhe_suspensao_dfe,\\r\\n    contrib.dt_alteracao,\\r\\n    contrib.sn_dtec,\\r\\n    contrib.dt_credenciamento_dtec,\\r\\n    contrib.sn_simples_nacional_rfb,\\r\\n    \\r\\n    -- Colunas da tabela cancel_cnpj\\r\\n    cancel.cnpj\\r\\n    --cancel.malhas\\r\\nFROM teste.cancel_cnpj cancel\\r\\nJOIN usr_sat_ods.vw_cad_contrib contrib\\r\\n    ON cancel.cnpj = contrib.nu_cnpj;\"], \"aceSize\": 100, \"status\": \"ready\", \"statusForButtons\": \"executed\", \"properties\": {\"settings\": []}, \"viewSettings\": {\"placeHolder\": \"Exemplo: SELECT * FROM tablename ou pressione CTRL + espa\\u00e7o\", \"sqlDialect\": true}, \"variables\": [], \"hasCurlyBracketParameters\": true, \"variableNames\": [], \"variableValues\": {}, \"statement\": \"--SELECT \\r\\n--    nu_cnpj AS cnpj,\\r\\n--    nm_razao_social,\\r\\n--    nm_fantasia,\\r\\n--    cd_sit_cadastral,\\r\\n--    nm_sit_cadastral,\\r\\n--    cd_reg_apuracao,\\r\\n--    nm_reg_apuracao,\\r\\n--    sn_suspensao_dfe,\\r\\n--    dt_suspensao_dfe,\\r\\n--    tx_detalhe_suspensao_dfe,\\r\\n--    sn_simples_nacional_rfb,\\r\\n--    cd_cnae,\\r\\n--    cd_cnae1,\\r\\n--    cd_cnae2,\\r\\n--    cd_cnae3,\\r\\n--    tx_outras_cnaes\\r\\n--FROM \\r\\n--    teste.cancel_cadastro\\r\\n\\r\\n-- Remover a tabela se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_cadastro;\", \"result\": {\"id\": \"86a26113-14cf-e67d-82c0-107580364c43\", \"type\": \"table\", \"hasResultset\": true, \"handle\": {\"secret\": \"aZze3cJWTpuAL4u06/eikg==\", \"guid\": \"B52BO5OiQqwAAAAA6+PB0A==\", \"operation_type\": 0, \"has_result_set\": true, \"modified_row_count\": null, \"log_context\": null, \"session_guid\": \"984b6f311745cffa:2ddd378c7babe5a5\", \"session_id\": 14429, \"session_type\": \"impala\", \"statement_id\": 1, \"has_more_statements\": false, \"statements_count\": 2, \"previous_statement_hash\": \"5daf48155d7edb101b6ed62be06f748e879d7a9e508db4dc4d86ac47\", \"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 110, \"column\": 36}, \"statement\": \"-- Criar a nova tabela\\nCREATE TABLE teste.cancel_cadastro AS\\nSELECT \\n    -- Colunas do contribuinte\\n    contrib.nu_cnpj,\\n    contrib.nu_cnpj_grupo,\\n    contrib.nu_ie,\\n    contrib.cd_usefi,\\n    contrib.nm_usefi,\\n    contrib.cd_gerfe,\\n    contrib.nm_gerfe,\\n    contrib.dt_inclusao_cad,\\n    contrib.dt_ult_atualiz,\\n    contrib.dt_constituicao_empresa,\\n    contrib.nm_razao_social,\\n    contrib.nm_fantasia,\\n    contrib.cd_sit_cadastral,\\n    contrib.nm_sit_cadastral,\\n    contrib.dt_sit_cadastral,\\n    contrib.cd_natureza_juridica,\\n    contrib.nm_natureza_juridica,\\n    contrib.dt_inicio_icms,\\n    contrib.cd_cnae,\\n    contrib.de_cnae,\\n    contrib.cd_secao,\\n    contrib.de_secao,\\n    contrib.cd_divisao,\\n    contrib.de_divisao,\\n    contrib.cd_grupo,\\n    contrib.de_grupo,\\n    contrib.cd_classe,\\n    contrib.de_classe,\\n    contrib.qt_cnae_sec,\\n    contrib.cd_cnae1,\\n    contrib.nm_cnae1,\\n    contrib.cd_cnae2,\\n    contrib.nm_cnae2,\\n    contrib.cd_cnae3,\\n    contrib.nm_cnae3,\\n    contrib.tx_outras_cnaes,\\n    contrib.tx_lista_cnae_sec,\\n    contrib.cd_reg_apuracao,\\n    contrib.nm_reg_apuracao,\\n    contrib.cd_enq_empresa,\\n    contrib.nm_enq_empresa,\\n    contrib.sn_apur_consolidada,\\n    contrib.sn_estab_consolidado,\\n    contrib.sn_estab_consolidador,\\n    contrib.sn_matriz,\\n    contrib.nu_ie_consolidador,\\n    contrib.cd_ges,\\n    contrib.nm_ges,\\n    contrib.cd_munic,\\n    contrib.nm_munic,\\n    contrib.cd_uf,\\n    contrib.nm_logradouro,\\n    contrib.nu_logradouro,\\n    contrib.tx_complemento,\\n    contrib.tx_referencia,\\n    contrib.nm_bairro,\\n    contrib.cd_cep,\\n    contrib.nu_telefone,\\n    contrib.nm_email,\\n    contrib.nu_cpf_cnpj_contador,\\n    contrib.nm_contador,\\n    contrib.nu_crc_contador,\\n    contrib.nu_telefone_contador,\\n    contrib.nm_email_contador,\\n    contrib.dt_ini_relac_contador,\\n    contrib.cd_munic_contador,\\n    contrib.nm_munic_contador,\\n    contrib.cd_uf_contador,\\n    contrib.nm_logradouro_contador,\\n    contrib.nu_logradouro_contador,\\n    contrib.nm_bairro_contador,\\n    contrib.cd_cep_contador,\\n    contrib.dt_inclusao_ods,\\n    contrib.dt_ult_atualiz_ods,\\n    contrib.id_seq_ult_alt,\\n    contrib.nu_ie_rge_ruc,\\n    contrib.qt_vinculos,\\n    contrib.qt_vinculos_ativos,\\n    contrib.qt_socios,\\n    contrib.qt_socios_ativos,\\n    contrib.qt_adm,\\n    contrib.qt_adm_ativos,\\n    contrib.qt_repres,\\n    contrib.qt_repres_ativos,\\n    contrib.qt_contab,\\n    contrib.qt_contab_ativos,\\n    contrib.qt_pessoas_vinc,\\n    contrib.qt_pessoas_vinc_ativos,\\n    contrib.cd_tipo_contribuinte,\\n    contrib.nm_tipo_contribuinte,\\n    contrib.sn_suspensao_dfe,\\n    contrib.dt_suspensao_dfe,\\n    contrib.tx_detalhe_suspensao_dfe,\\n    contrib.dt_alteracao,\\n    contrib.sn_dtec,\\n    contrib.dt_credenciamento_dtec,\\n    contrib.sn_simples_nacional_rfb,\\n    \\n    -- Colunas da tabela cancel_cnpj\\n    cancel.cnpj\\n    --cancel.malhas\\nFROM teste.cancel_cnpj cancel\\nJOIN usr_sat_ods.vw_cad_contrib contrib\\n    ON cancel.cnpj = contrib.nu_cnpj\"}, \"meta\": [], \"rows\": null, \"hasMore\": false, \"statement_id\": 1, \"statement_range\": {\"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 110, \"column\": 36}}, \"statements_count\": 1, \"previous_statement_hash\": null, \"metaFilter\": {\"query\": \"\", \"facets\": {}, \"text\": []}, \"isMetaFilterVisible\": false, \"filteredMetaChecked\": true, \"filteredColumnCount\": -1, \"filteredMeta\": [], \"fetchedOnce\": false, \"startTime\": \"2025-04-10T17:51:30.978Z\", \"endTime\": \"2025-04-10T17:51:31.140Z\", \"executionTime\": 162, \"data\": [], \"explanation\": \"\", \"logs\": \"\", \"logLines\": 0, \"hasSomeResults\": false}, \"showGrid\": true, \"showChart\": false, \"showLogs\": true, \"progress\": 0, \"jobs\": [], \"executeNextTimeout\": -1, \"isLoading\": false, \"resultsKlass\": \"results impala\", \"errorsKlass\": \"results impala alert alert-error\", \"is_redacted\": false, \"chartType\": \"bars\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartLimits\": [5, 10, 25, 50, 100], \"chartLimit\": null, \"chartX\": null, \"chartXPivot\": null, \"chartYSingle\": null, \"chartYMulti\": [], \"chartData\": [], \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"hideStacked\": true, \"hasDataForChart\": false, \"previousChartOptions\": {\"chartLimit\": null, \"chartX\": null, \"chartXPivot\": null, \"chartYSingle\": null, \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"chartYMulti\": [], \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null}, \"isResultSettingsVisible\": false, \"settingsVisible\": false, \"checkStatusTimeout\": null, \"getLogsTimeout\": null, \"topRisk\": null, \"suggestion\": \"\", \"hasSuggestion\": null, \"compatibilityCheckRunning\": false, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"compatibilitySourcePlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"compatibilityTargetPlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"showSqlAnalyzer\": false, \"wasBatchExecuted\": false, \"isReady\": true, \"lastExecuted\": 1744307490593, \"lastAceSelectionRowOffset\": 0, \"executingBlockingOperation\": null, \"showLongOperationWarning\": false, \"formatEnabled\": true, \"isFetchingData\": false, \"isCanceling\": false, \"aceAutoExpand\": false}], \"selectedSnippet\": \"impala\", \"creatingSessionLocks\": [], \"sessions\": [], \"directoryUuid\": \"\", \"dependentsCoordinator\": [], \"historyFilter\": \"\", \"historyFilterVisible\": false, \"loadingHistory\": false, \"historyInitialHeight\": 78, \"forceHistoryInitialHeight\": false, \"historyCurrentPage\": 1, \"historyTotalPages\": 28, \"schedulerViewModel\": null, \"schedulerViewModelIsLoaded\": false, \"isBatchable\": true, \"isExecutingAll\": false, \"executingAllIndex\": 0, \"retryModalConfirm\": null, \"retryModalCancel\": null, \"canSave\": true, \"unloaded\": false, \"updateHistoryFailed\": false, \"viewSchedulerId\": \"\", \"loadingScheduler\": false}",
    "extra": "",
    "search": "--SELECT \r\n--    nu_cnpj AS cnpj,\r\n--    nm_razao_social,\r\n--    nm_fantasia,\r\n--    cd_sit_cadastral,\r\n--    nm_sit_cadastral,\r\n--    cd_reg_apuracao,\r\n--    nm_reg_apuracao,\r\n--    sn_suspensao_dfe,\r\n--    dt_suspensao_dfe,\r\n--    tx_detalhe_suspensao_dfe,\r\n--    sn_simples_nacional_rfb,\r\n--    cd_cnae,\r\n--    cd_cnae1,\r\n--    cd_cnae2,\r\n--    cd_cnae3,\r\n--    tx_outras_cnaes\r\n--FROM \r\n--    teste.cancel_cadastro\r\n\r\n-- Remover a tabela se existir\r\nDROP TABLE IF EXISTS teste.cancel_cadastro;\r\n\r\n-- Criar a nova tabela\r\nCREATE TABLE teste.cancel_cadastro AS\r\nSELECT \r\n    -- Colunas do contribuinte\r\n    contrib.nu_cnpj,\r\n    contrib.nu_cnpj_grupo,\r\n    contrib.nu_ie,\r\n    contrib.cd_usefi,\r\n    contrib.nm_usefi,\r\n    contrib.cd_gerfe,\r\n    contrib.nm_gerfe,\r\n    contrib.dt_inclusao_cad,\r\n    contrib.dt_ult_atualiz,\r\n    contrib.dt_constituicao_empresa,\r\n    contrib.nm_razao_social,\r\n    contrib.nm_fantasia,\r\n    contrib.cd_sit_cadastral,\r\n    contrib.nm_sit_cadastral,\r\n    contrib.dt_sit_cadastral,\r\n    contrib.cd_natureza_juridica,\r\n    contrib.nm_natureza_juridica,\r\n    contrib.dt_inicio_icms,\r\n    contrib.cd_cnae,\r\n    contrib.de_cnae,\r\n    contrib.cd_secao,\r\n    contrib.de_secao,\r\n    contrib.cd_divisao,\r\n    contrib.de_divisao,\r\n    contrib.cd_grupo,\r\n    contrib.de_grupo,\r\n    contrib.cd_classe,\r\n    contrib.de_classe,\r\n    contrib.qt_cnae_sec,\r\n    contrib.cd_cnae1,\r\n    contrib.nm_cnae1,\r\n    contrib.cd_cnae2,\r\n    contrib.nm_cnae2,\r\n    contrib.cd_cnae3,\r\n    contrib.nm_cnae3,\r\n    contrib.tx_outras_cnaes,\r\n    contrib.tx_lista_cnae_sec,\r\n    contrib.cd_reg_apuracao,\r\n    contrib.nm_reg_apuracao,\r\n    contrib.cd_enq_empresa,\r\n    contrib.nm_enq_empresa,\r\n    contrib.sn_apur_consolidada,\r\n    contrib.sn_estab_consolidado,\r\n    contrib.sn_estab_consolidador,\r\n    contrib.sn_matriz,\r\n    contrib.nu_ie_consolidador,\r\n    contrib.cd_ges,\r\n    contrib.nm_ges,\r\n    contrib.cd_munic,\r\n    contrib.nm_munic,\r\n    contrib.cd_uf,\r\n    contrib.nm_logradouro,\r\n    contrib.",
    "last_modified": "2025-04-10T15:58:33.640",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "4021901f-ed7a-4fd2-b5bf-8647d6b477af",
      1,
      false
    ],
    "dependencies": []
  }
},
{
  "model": "desktop.document2",
  "pk": 115664,
  "fields": {
    "owner": [
      "tsevero"
    ],
    "name": "CANCEL: 3 RECOLHIMENTOS",
    "description": "",
    "uuid": "9615ecb1-3e48-6ea5-9447-ff6a8cb11d4c",
    "type": "query-impala",
    "connector": null,
    "data": "{\"id\": 115664, \"uuid\": \"195e3dea-e024-4651-ab38-d157d51125e4\", \"name\": \"CANCEL: 3 RECOLHIMENTOS\", \"description\": \"\", \"type\": \"query-impala\", \"initialType\": \"impala\", \"coordinatorUuid\": null, \"isHistory\": false, \"isManaged\": false, \"parentSavedQueryUuid\": \"9615ecb1-3e48-6ea5-9447-ff6a8cb11d4c\", \"isSaved\": true, \"onSuccessUrl\": null, \"pubSubUrl\": null, \"isPresentationModeDefault\": false, \"isPresentationMode\": false, \"isPresentationModeInitialized\": true, \"presentationSnippets\": {}, \"isHidingCode\": false, \"snippets\": [{\"id\": \"6c1feb79-997b-f397-3f66-8ceab8a12323\", \"name\": \"\", \"type\": \"impala\", \"connector\": {\"name\": \"Impala\", \"type\": \"impala\", \"id\": \"impala\", \"displayName\": \"Impala\", \"buttonName\": \"Consulta\", \"tooltip\": \"Impala Query\", \"optimizer\": \"off\", \"page\": \"/editor/?type=impala\", \"is_sql\": true, \"is_batchable\": true, \"dialect\": \"impala\", \"dialect_properties\": {}}, \"isSqlDialect\": true, \"dialect\": \"impala\", \"isBatchable\": true, \"autocompleteSettings\": {\"temporaryOnly\": false}, \"aceCursorPosition\": {\"row\": 3, \"column\": 22}, \"errors\": [], \"aceErrorsHolder\": [], \"aceWarningsHolder\": [], \"aceErrors\": [], \"aceWarnings\": [], \"editorMode\": true, \"dbSelectionVisible\": false, \"showExecutionAnalysis\": true, \"namespace\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"status\": \"CREATED\", \"computes\": [{\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"type\": \"direct\", \"credentials\": {}}]}, \"compute\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"namespace\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"interface\": \"impala\", \"type\": \"direct\", \"options\": {}}, \"database\": \"teste\", \"currentQueryTab\": \"queryResults\", \"pinnedContextTabs\": [], \"loadingQueries\": false, \"queriesHasErrors\": false, \"queriesCurrentPage\": 1, \"queriesTotalPages\": 2, \"queriesFilter\": \"\", \"queriesFilterVisible\": false, \"statementType\": \"text\", \"statementTypes\": [\"text\", \"file\"], \"statementPath\": \"\", \"externalStatementLoaded\": false, \"associatedDocumentLoading\": true, \"associatedDocumentUuid\": null, \"statement_raw\": \"-- Dropar a tabela se ela j\\u00e1 existir\\r\\nDROP TABLE IF EXISTS teste.cancel_recolhimento;\\r\\n\\r\\n-- Criar a nova tabela\\r\\nCREATE TABLE teste.cancel_recolhimento AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Consulta para extrair os pagamentos conforme os filtros especificados\\r\\npagamentos AS (\\r\\n  SELECT \\r\\n    p.nu_cnpj,\\r\\n    p.nu_id_pagamento,\\r\\n    p.vl_total,\\r\\n    p.nu_per_pagamento,\\r\\n    p.cd_receita\\r\\n  FROM usr_sat_ods.vw_ods_pagamento p\\r\\n  WHERE p.nu_per_pagamento IN (202502, 202501, 202412, 202411, 202410, 202409, 202408, 202407)\\r\\n    AND p.cd_receita IN (1449, 1465, 1473, 1554, 1570, 1589, 1597, 1600, 1643, 1651, \\r\\n                         1716, 1724, 1732, 1740, 1759, 1767, 1783, 1791, 2140, 2496, \\r\\n                         2526, 2534, 3000, 3050, 3662, 4383, 7110, 7137, 9687, 9784)\\r\\n),\\r\\n\\r\\n-- Agrupar os pagamentos por CNPJ\\r\\npagamentos_agrupados AS (\\r\\n  SELECT \\r\\n    REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo,\\r\\n    COUNT(p.nu_id_pagamento) AS quantidade_pagtos,\\r\\n    SUM(p.vl_total) AS valor_pagtos\\r\\n  FROM pagamentos p\\r\\n  GROUP BY REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n)\\r\\n\\r\\n-- Resultado final\\r\\nSELECT \\r\\n  cb.cnpj,\\r\\n  COALESCE(pa.quantidade_pagtos, 0) AS quantidade_pagtos,\\r\\n  COALESCE(pa.valor_pagtos, 0) AS valor_pagtos\\r\\nFROM cnpj_base cb\\r\\nLEFT JOIN pagamentos_agrupados pa\\r\\n  ON cb.cnpj_limpo = pa.cnpj_limpo;\", \"statementsList\": [\"-- Dropar a tabela se ela j\\u00e1 existir\\r\\nDROP TABLE IF EXISTS teste.cancel_recolhimento;\", \"\\r\\n\\r\\n-- Criar a nova tabela\\r\\nCREATE TABLE teste.cancel_recolhimento AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Consulta para extrair os pagamentos conforme os filtros especificados\\r\\npagamentos AS (\\r\\n  SELECT \\r\\n    p.nu_cnpj,\\r\\n    p.nu_id_pagamento,\\r\\n    p.vl_total,\\r\\n    p.nu_per_pagamento,\\r\\n    p.cd_receita\\r\\n  FROM usr_sat_ods.vw_ods_pagamento p\\r\\n  WHERE p.nu_per_pagamento IN (202502, 202501, 202412, 202411, 202410, 202409, 202408, 202407)\\r\\n    AND p.cd_receita IN (1449, 1465, 1473, 1554, 1570, 1589, 1597, 1600, 1643, 1651, \\r\\n                         1716, 1724, 1732, 1740, 1759, 1767, 1783, 1791, 2140, 2496, \\r\\n                         2526, 2534, 3000, 3050, 3662, 4383, 7110, 7137, 9687, 9784)\\r\\n),\\r\\n\\r\\n-- Agrupar os pagamentos por CNPJ\\r\\npagamentos_agrupados AS (\\r\\n  SELECT \\r\\n    REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo,\\r\\n    COUNT(p.nu_id_pagamento) AS quantidade_pagtos,\\r\\n    SUM(p.vl_total) AS valor_pagtos\\r\\n  FROM pagamentos p\\r\\n  GROUP BY REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n)\\r\\n\\r\\n-- Resultado final\\r\\nSELECT \\r\\n  cb.cnpj,\\r\\n  COALESCE(pa.quantidade_pagtos, 0) AS quantidade_pagtos,\\r\\n  COALESCE(pa.valor_pagtos, 0) AS valor_pagtos\\r\\nFROM cnpj_base cb\\r\\nLEFT JOIN pagamentos_agrupados pa\\r\\n  ON cb.cnpj_limpo = pa.cnpj_limpo;\"], \"aceSize\": 100, \"status\": \"available\", \"statusForButtons\": \"executed\", \"properties\": {\"settings\": []}, \"viewSettings\": {\"placeHolder\": \"Exemplo: SELECT * FROM tablename ou pressione CTRL + espa\\u00e7o\", \"sqlDialect\": true}, \"variables\": [], \"hasCurlyBracketParameters\": true, \"variableNames\": [], \"variableValues\": {}, \"statement\": \"\\r\\n\\r\\n-- Criar a nova tabela\\r\\nCREATE TABLE teste.cancel_recolhimento AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Consulta para extrair os pagamentos conforme os filtros especificados\\r\\npagamentos AS (\\r\\n  SELECT \\r\\n    p.nu_cnpj,\\r\\n    p.nu_id_pagamento,\\r\\n    p.vl_total,\\r\\n    p.nu_per_pagamento,\\r\\n    p.cd_receita\\r\\n  FROM usr_sat_ods.vw_ods_pagamento p\\r\\n  WHERE p.nu_per_pagamento IN (202502, 202501, 202412, 202411, 202410, 202409, 202408, 202407)\\r\\n    AND p.cd_receita IN (1449, 1465, 1473, 1554, 1570, 1589, 1597, 1600, 1643, 1651, \\r\\n                         1716, 1724, 1732, 1740, 1759, 1767, 1783, 1791, 2140, 2496, \\r\\n                         2526, 2534, 3000, 3050, 3662, 4383, 7110, 7137, 9687, 9784)\\r\\n),\\r\\n\\r\\n-- Agrupar os pagamentos por CNPJ\\r\\npagamentos_agrupados AS (\\r\\n  SELECT \\r\\n    REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo,\\r\\n    COUNT(p.nu_id_pagamento) AS quantidade_pagtos,\\r\\n    SUM(p.vl_total) AS valor_pagtos\\r\\n  FROM pagamentos p\\r\\n  GROUP BY REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n)\\r\\n\\r\\n-- Resultado final\\r\\nSELECT \\r\\n  cb.cnpj,\\r\\n  COALESCE(pa.quantidade_pagtos, 0) AS quantidade_pagtos,\\r\\n  COALESCE(pa.valor_pagtos, 0) AS valor_pagtos\\r\\nFROM cnpj_base cb\\r\\nLEFT JOIN pagamentos_agrupados pa\\r\\n  ON cb.cnpj_limpo = pa.cnpj_limpo;\", \"result\": {\"id\": \"3395bf3b-dddb-181c-2bf0-733547900aab\", \"type\": \"table\", \"hasResultset\": true, \"handle\": {\"secret\": \"wc5260uUSmut4kVduEeWIA==\", \"guid\": \"g9zzM+wwT5sAAAAA/8TEsw==\", \"operation_type\": 0, \"has_result_set\": true, \"modified_row_count\": null, \"log_context\": null, \"session_guid\": \"984a3f5b613b2bf7:a220dd64b4a89c88\", \"session_id\": 16933, \"session_type\": \"impala\", \"statement_id\": 1, \"has_more_statements\": false, \"statements_count\": 2, \"previous_statement_hash\": \"f674f06c4c563aa91485e1d18798248f68249d7baff81ba12de84058\", \"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 46, \"column\": 34}, \"statement\": \"-- Criar a nova tabela\\nCREATE TABLE gessimples.gecob_recolhimento AS\\nWITH \\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\ncnpj_base AS (\\n  SELECT \\n    cnpj,\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\n  FROM gessimples.gecob_cnpj\\n),\\n\\n-- Consulta para extrair os pagamentos conforme os filtros especificados\\npagamentos AS (\\n  SELECT \\n    p.nu_cnpj,\\n    p.nu_id_pagamento,\\n    p.vl_total,\\n    p.nu_per_pagamento,\\n    p.cd_receita\\n  FROM usr_sat_ods.vw_ods_pagamento p\\n  WHERE p.nu_per_pagamento IN (202502, 202501, 202412, 202411, 202410, 202409, 202408, 202407)\\n    AND p.cd_receita IN (1449, 1465, 1473, 1554, 1570, 1589, 1597, 1600, 1643, 1651, \\n                         1716, 1724, 1732, 1740, 1759, 1767, 1783, 1791, 2140, 2496, \\n                         2526, 2534, 3000, 3050, 3662, 4383, 7110, 7137, 9687, 9784)\\n),\\n\\n-- Agrupar os pagamentos por CNPJ\\npagamentos_agrupados AS (\\n  SELECT \\n    REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo,\\n    COUNT(p.nu_id_pagamento) AS quantidade_pagtos,\\n    SUM(p.vl_total) AS valor_pagtos\\n  FROM pagamentos p\\n  GROUP BY REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '')\\n)\\n\\n-- Resultado final\\nSELECT \\n  cb.cnpj,\\n  COALESCE(pa.quantidade_pagtos, 0) AS quantidade_pagtos,\\n  COALESCE(pa.valor_pagtos, 0) AS valor_pagtos\\nFROM cnpj_base cb\\nLEFT JOIN pagamentos_agrupados pa\\n  ON cb.cnpj_limpo = pa.cnpj_limpo\"}, \"meta\": [], \"rows\": \"1\", \"hasMore\": false, \"statement_id\": 1, \"statement_range\": {\"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 46, \"column\": 34}}, \"statements_count\": 2, \"metaFilter\": {\"query\": \"\", \"facets\": {}, \"text\": []}, \"isMetaFilterVisible\": false, \"filteredMetaChecked\": true, \"filteredColumnCount\": 1, \"filteredMeta\": [{\"type\": \"int\", \"name\": \"\", \"comment\": null, \"cssClass\": \"sort-numeric\", \"checked\": true, \"originalIndex\": 0}, {\"name\": \"summary\", \"type\": \"string\", \"comment\": null, \"cssClass\": \"sort-string\", \"checked\": true, \"originalIndex\": 1}], \"fetchedOnce\": false, \"startTime\": \"2025-06-13T19:32:04.116Z\", \"endTime\": \"2025-06-13T19:32:07.801Z\", \"executionTime\": 3685, \"data\": [], \"explanation\": \"\", \"logs\": \"\", \"logLines\": 6, \"hasSomeResults\": true}, \"showGrid\": true, \"showChart\": false, \"showLogs\": true, \"progress\": 0, \"jobs\": [], \"executeNextTimeout\": -1, \"isLoading\": false, \"resultsKlass\": \"results impala\", \"errorsKlass\": \"results impala alert alert-error\", \"is_redacted\": false, \"chartType\": \"bars\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartLimits\": [5, 10, 25, 50, 100], \"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartYMulti\": [], \"chartData\": [], \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"hideStacked\": true, \"hasDataForChart\": false, \"previousChartOptions\": {\"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"chartYMulti\": [], \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null}, \"isResultSettingsVisible\": false, \"settingsVisible\": false, \"checkStatusTimeout\": 21852, \"getLogsTimeout\": 21920, \"topRisk\": null, \"suggestion\": \"\", \"hasSuggestion\": null, \"compatibilityCheckRunning\": false, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"compatibilitySourcePlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"compatibilityTargetPlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"showSqlAnalyzer\": false, \"wasBatchExecuted\": false, \"isReady\": true, \"lastExecuted\": 1749843123771, \"lastAceSelectionRowOffset\": 0, \"executingBlockingOperation\": null, \"showLongOperationWarning\": false, \"lastExecutedStatements\": \"-- Dropar a tabela se ela j\\u00e1 existir\\r\\nDROP TABLE IF EXISTS gessimples.gecob_recolhimento;\\r\\n\\r\\n-- Criar a nova tabela\\r\\nCREATE TABLE gessimples.gecob_recolhimento AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM gessimples.gecob_cnpj\\r\\n),\\r\\n\\r\\n-- Consulta para extrair os pagamentos conforme os filtros especificados\\r\\npagamentos AS (\\r\\n  SELECT \\r\\n    p.nu_cnpj,\\r\\n    p.nu_id_pagamento,\\r\\n    p.vl_total,\\r\\n    p.nu_per_pagamento,\\r\\n    p.cd_receita\\r\\n  FROM usr_sat_ods.vw_ods_pagamento p\\r\\n  WHERE p.nu_per_pagamento IN (202502, 202501, 202412, 202411, 202410, 202409, 202408, 202407)\\r\\n    AND p.cd_receita IN (1449, 1465, 1473, 1554, 1570, 1589, 1597, 1600, 1643, 1651, \\r\\n                         1716, 1724, 1732, 1740, 1759, 1767, 1783, 1791, 2140, 2496, \\r\\n                         2526, 2534, 3000, 3050, 3662, 4383, 7110, 7137, 9687, 9784)\\r\\n),\\r\\n\\r\\n-- Agrupar os pagamentos por CNPJ\\r\\npagamentos_agrupados AS (\\r\\n  SELECT \\r\\n    REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo,\\r\\n    COUNT(p.nu_id_pagamento) AS quantidade_pagtos,\\r\\n    SUM(p.vl_total) AS valor_pagtos\\r\\n  FROM pagamentos p\\r\\n  GROUP BY REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n)\\r\\n\\r\\n-- Resultado final\\r\\nSELECT \\r\\n  cb.cnpj,\\r\\n  COALESCE(pa.quantidade_pagtos, 0) AS quantidade_pagtos,\\r\\n  COALESCE(pa.valor_pagtos, 0) AS valor_pagtos\\r\\nFROM cnpj_base cb\\r\\nLEFT JOIN pagamentos_agrupados pa\\r\\n  ON cb.cnpj_limpo = pa.cnpj_limpo;\", \"lastExecutedSelectionRange\": {\"start\": {\"row\": 0, \"column\": 0}, \"end\": {\"row\": 46, \"column\": 35}}, \"formatEnabled\": true, \"isFetchingData\": false, \"isCanceling\": false, \"aceAutoExpand\": false, \"lastCheckStatusRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"query_status\\\": {\\\"status\\\": \\\"available\\\"}}\", \"responseJSON\": {\"status\": 0, \"query_status\": {\"status\": \"available\"}}, \"status\": 200, \"statusText\": \"OK\"}, \"lastGetLogsRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"logs\\\": \\\"Query 9b4f30ec33f3dc83:b3c4c4ff00000000 100% Complete (109 out of 109)\\\", \\\"progress\\\": 100, \\\"jobs\\\": [{\\\"name\\\": \\\"9b4f30ec33f3dc83:b3c4c4ff00000000\\\", \\\"url\\\": \\\"/hue/jobbrowser#!id=9b4f30ec33f3dc83:b3c4c4ff00000000\\\", \\\"started\\\": true, \\\"finished\\\": false, \\\"percentJob\\\": 100}], \\\"isFullLogs\\\": false}\", \"responseJSON\": {\"status\": 0, \"logs\": \"Query 9b4f30ec33f3dc83:b3c4c4ff00000000 100% Complete (109 out of 109)\", \"progress\": 100, \"jobs\": [{\"name\": \"9b4f30ec33f3dc83:b3c4c4ff00000000\", \"url\": \"/hue/jobbrowser#!id=9b4f30ec33f3dc83:b3c4c4ff00000000\", \"started\": true, \"finished\": false, \"percentJob\": 100}], \"isFullLogs\": false}, \"status\": 200, \"statusText\": \"OK\"}}], \"selectedSnippet\": \"impala\", \"creatingSessionLocks\": [], \"sessions\": [], \"directoryUuid\": \"\", \"dependentsCoordinator\": [], \"historyFilter\": \"\", \"historyFilterVisible\": false, \"loadingHistory\": false, \"historyInitialHeight\": 14947, \"forceHistoryInitialHeight\": false, \"historyCurrentPage\": 1, \"historyTotalPages\": 51, \"schedulerViewModel\": null, \"schedulerViewModelIsLoaded\": false, \"isBatchable\": true, \"isExecutingAll\": false, \"executingAllIndex\": 0, \"retryModalConfirm\": null, \"retryModalCancel\": null, \"canSave\": true, \"unloaded\": false, \"updateHistoryFailed\": false, \"viewSchedulerId\": \"\", \"loadingScheduler\": false}",
    "extra": "",
    "search": "-- Dropar a tabela se ela jÃ¡ existir\r\nDROP TABLE IF EXISTS teste.cancel_recolhimento;\r\n\r\n-- Criar a nova tabela\r\nCREATE TABLE teste.cancel_recolhimento AS\r\nWITH \r\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\r\ncnpj_base AS (\r\n  SELECT \r\n    cnpj,\r\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\r\n  FROM teste.cancel_cnpj\r\n),\r\n\r\n-- Consulta para extrair os pagamentos conforme os filtros especificados\r\npagamentos AS (\r\n  SELECT \r\n    p.nu_cnpj,\r\n    p.nu_id_pagamento,\r\n    p.vl_total,\r\n    p.nu_per_pagamento,\r\n    p.cd_receita\r\n  FROM usr_sat_ods.vw_ods_pagamento p\r\n  WHERE p.nu_per_pagamento IN (202502, 202501, 202412, 202411, 202410, 202409, 202408, 202407)\r\n    AND p.cd_receita IN (1449, 1465, 1473, 1554, 1570, 1589, 1597, 1600, 1643, 1651, \r\n                         1716, 1724, 1732, 1740, 1759, 1767, 1783, 1791, 2140, 2496, \r\n                         2526, 2534, 3000, 3050, 3662, 4383, 7110, 7137, 9687, 9784)\r\n),\r\n\r\n-- Agrupar os pagamentos por CNPJ\r\npagamentos_agrupados AS (\r\n  SELECT \r\n    REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo,\r\n    COUNT(p.nu_id_pagamento) AS quantidade_pagtos,\r\n    SUM(p.vl_total) AS valor_pagtos\r\n  FROM pagamentos p\r\n  GROUP BY REGEXP_REPLACE(TRIM(CAST(p.nu_cnpj AS STRING)), '[^0-9]', '')\r\n)\r\n\r\n-- Resultado final\r\nSELECT \r\n  cb.cnpj,\r\n  COALESCE(pa.quantidade_pagtos, 0) AS quantidade_pagtos,\r\n  COALESCE(pa.valor_pagtos, 0) AS valor_pagtos\r\nFROM cnpj_base cb\r\nLEFT JOIN pagamentos_agrupados pa\r\n  ON cb.cnpj_limpo = pa.cnpj_limpo;",
    "last_modified": "2025-06-13T16:32:24.219",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "4021901f-ed7a-4fd2-b5bf-8647d6b477af",
      1,
      false
    ],
    "dependencies": []
  }
},
{
  "model": "desktop.document2",
  "pk": 115668,
  "fields": {
    "owner": [
      "tsevero"
    ],
    "name": "CANCEL: 4 ZERO DIME PGDAS",
    "description": "",
    "uuid": "854e55fa-9ed9-f6a0-ea12-ad1c027ebf68",
    "type": "query-impala",
    "connector": null,
    "data": "{\"id\": 115668, \"uuid\": \"7d0e952e-ce2f-4730-85cb-4cb44529d3c4\", \"name\": \"CANCEL: 4 ZERO DIME PGDAS\", \"description\": \"\", \"type\": \"query-impala\", \"initialType\": \"impala\", \"coordinatorUuid\": null, \"isHistory\": false, \"isManaged\": false, \"parentSavedQueryUuid\": \"854e55fa-9ed9-f6a0-ea12-ad1c027ebf68\", \"isSaved\": true, \"onSuccessUrl\": null, \"pubSubUrl\": null, \"isPresentationModeDefault\": false, \"isPresentationMode\": false, \"isPresentationModeInitialized\": true, \"presentationSnippets\": {}, \"isHidingCode\": false, \"snippets\": [{\"id\": \"e2e38ab7-3ad7-7c30-1533-eb9cfa6ee231\", \"name\": \"\", \"type\": \"impala\", \"connector\": {\"name\": \"Impala\", \"type\": \"impala\", \"id\": \"impala\", \"displayName\": \"Impala\", \"buttonName\": \"Consulta\", \"tooltip\": \"Impala Query\", \"optimizer\": \"off\", \"page\": \"/editor/?type=impala\", \"is_sql\": true, \"is_batchable\": true, \"dialect\": \"impala\", \"dialect_properties\": {}}, \"isSqlDialect\": true, \"dialect\": \"impala\", \"isBatchable\": true, \"autocompleteSettings\": {\"temporaryOnly\": false}, \"aceCursorPosition\": {\"row\": 288, \"column\": 74}, \"errors\": [], \"aceErrorsHolder\": [], \"aceWarningsHolder\": [], \"aceErrors\": [], \"aceWarnings\": [], \"editorMode\": true, \"dbSelectionVisible\": false, \"showExecutionAnalysis\": true, \"namespace\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"status\": \"CREATED\", \"computes\": [{\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"type\": \"direct\", \"credentials\": {}}]}, \"compute\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"namespace\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"interface\": \"impala\", \"type\": \"direct\", \"options\": {}}, \"database\": \"nfe\", \"currentQueryTab\": \"queryResults\", \"pinnedContextTabs\": [], \"loadingQueries\": false, \"queriesHasErrors\": false, \"queriesCurrentPage\": 1, \"queriesTotalPages\": 1, \"queriesFilter\": \"\", \"queriesFilterVisible\": false, \"statementType\": \"text\", \"statementTypes\": [\"text\", \"file\"], \"statementPath\": \"\", \"externalStatementLoaded\": false, \"associatedDocumentLoading\": true, \"associatedDocumentUuid\": null, \"statement_raw\": \"-- 1. Dropar as tabelas existentes\\r\\nDROP TABLE IF EXISTS teste.cancel_zero_normal;\\r\\nDROP TABLE IF EXISTS teste.cancel_zero_simples;\\r\\n\\r\\n-- 2. Criar tabela para NORMAL\\r\\nCREATE TABLE teste.cancel_zero_normal AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Per\\u00edodos a serem analisados\\r\\nperiodos AS (\\r\\n  SELECT periodo \\r\\n  FROM (\\r\\n    SELECT 202502 AS periodo UNION ALL\\r\\n    SELECT 202501 AS periodo UNION ALL\\r\\n    SELECT 202412 AS periodo UNION ALL\\r\\n    SELECT 202411 AS periodo UNION ALL\\r\\n    SELECT 202410 AS periodo UNION ALL\\r\\n    SELECT 202409 AS periodo UNION ALL\\r\\n    SELECT 202408 AS periodo UNION ALL\\r\\n    SELECT 202407 AS periodo\\r\\n  ) p\\r\\n),\\r\\n\\r\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\r\\nmatriz_cnpj_periodo AS (\\r\\n  SELECT \\r\\n    cb.cnpj,\\r\\n    cb.cnpj_limpo,\\r\\n    p.periodo\\r\\n  FROM cnpj_base cb\\r\\n  CROSS JOIN periodos p\\r\\n),\\r\\n\\r\\n-- Agrega dados da usr_sat_ods.ods_decl_dime_raw (para NORMAL)\\r\\ndime_2024 AS (\\r\\n  SELECT \\r\\n    NU_CNPJ,\\r\\n    nu_per_ref AS periodo,\\r\\n    VL_RECEITA_BRUTA,\\r\\n    VL_FATURAMENTO,\\r\\n    VL_TOT_CRED,\\r\\n    VL_TOT_DEB,\\r\\n    VL_DEB_RECOLHER,\\r\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando todos os valores importantes s\\u00e3o zero)\\r\\n    CASE WHEN VL_RECEITA_BRUTA = 0 AND VL_FATURAMENTO = 0 AND VL_TOT_CRED = 0 AND VL_TOT_DEB = 0 AND VL_DEB_RECOLHER = 0\\r\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\r\\n  FROM usr_sat_ods.ods_decl_dime_raw\\r\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n),\\r\\n\\r\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para NORMAL\\r\\nestatisticas_normal AS (\\r\\n  SELECT\\r\\n    mp.cnpj,\\r\\n    mp.cnpj_limpo,\\r\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\r\\n    COUNT(DISTINCT d.periodo) AS periodos_declarados,\\r\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT d.periodo) AS periodos_omissos,\\r\\n    SUM(COALESCE(d.declaracao_zerada, 0)) AS periodos_zerados\\r\\n  FROM matriz_cnpj_periodo mp\\r\\n  LEFT JOIN dime_2024 d\\r\\n    ON REGEXP_REPLACE(TRIM(CAST(d.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\r\\n    AND d.periodo = mp.periodo\\r\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\r\\n),\\r\\n\\r\\n-- Agrega\\u00e7\\u00e3o de dados DIME por CNPJ para NORMAL\\r\\ndime_consolidado AS (\\r\\n  SELECT \\r\\n    NU_CNPJ,\\r\\n    SUM(VL_RECEITA_BRUTA) AS total_vl_receita_bruta,\\r\\n    SUM(VL_FATURAMENTO) AS total_vl_faturamento,\\r\\n    SUM(VL_TOT_CRED) AS total_vl_tot_cred,\\r\\n    SUM(VL_TOT_DEB) AS total_vl_tot_deb,\\r\\n    SUM(VL_DEB_RECOLHER) AS total_vl_deb_recolher\\r\\n  FROM dime_2024\\r\\n  GROUP BY NU_CNPJ\\r\\n),\\r\\n\\r\\n-- Dados de NF-e (usando o CNPJ do emitente)\\r\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\r\\nnfe_dados AS (\\r\\n  SELECT \\r\\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\r\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\r\\n  FROM nfe.nfe\\r\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\r\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\r\\n)\\r\\n\\r\\nSELECT\\r\\n  -- Colunas principais do contribuinte\\r\\n  c.nm_contador,\\r\\n  c.nu_cnpj,\\r\\n  c.nm_razao_social,\\r\\n  c.nm_fantasia,\\r\\n  c.nm_reg_apuracao,\\r\\n  cb.cnpj AS cnpj_base,\\r\\n  \\r\\n  -- Colunas espec\\u00edficas de NORMAL\\r\\n  d.total_vl_faturamento,\\r\\n  d.total_vl_receita_bruta,\\r\\n  d.total_vl_tot_cred,\\r\\n  d.total_vl_tot_deb,\\r\\n  d.total_vl_deb_recolher,\\r\\n  \\r\\n  -- Auditoria\\r\\n  aes.dt_constituicao_empresa,\\r\\n  \\r\\n  -- Dados de NFe\\r\\n  nfi.total_nfes_emitidas,\\r\\n  \\r\\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\r\\n  en.periodos_omissos,\\r\\n  en.periodos_zerados,\\r\\n  en.total_periodos,\\r\\n  en.periodos_declarados\\r\\n  \\r\\nFROM teste.cancel_cnpj cb\\r\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n\\r\\nLEFT JOIN dime_consolidado d\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(d.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN nfe_dados nfi\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN estatisticas_normal en\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = en.cnpj_limpo\\r\\n  \\r\\nWHERE c.nm_reg_apuracao = 'NORMAL' OR c.nm_reg_apuracao IS NULL;\\r\\n\\r\\n\\r\\n-- 3. Criar tabela para SIMPLES NACIONAL\\r\\nCREATE TABLE teste.cancel_zero_simples AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Per\\u00edodos a serem analisados\\r\\nperiodos AS (\\r\\n  SELECT periodo \\r\\n  FROM (\\r\\n    SELECT 202502 AS periodo UNION ALL\\r\\n    SELECT 202501 AS periodo UNION ALL\\r\\n    SELECT 202412 AS periodo UNION ALL\\r\\n    SELECT 202411 AS periodo UNION ALL\\r\\n    SELECT 202410 AS periodo UNION ALL\\r\\n    SELECT 202409 AS periodo UNION ALL\\r\\n    SELECT 202408 AS periodo UNION ALL\\r\\n    SELECT 202407 AS periodo\\r\\n  ) p\\r\\n),\\r\\n\\r\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\r\\nmatriz_cnpj_periodo AS (\\r\\n  SELECT \\r\\n    cb.cnpj,\\r\\n    cb.cnpj_limpo,\\r\\n    p.periodo\\r\\n  FROM cnpj_base cb\\r\\n  CROSS JOIN periodos p\\r\\n),\\r\\n\\r\\n-- Agrega dados do Simples Nacional\\r\\nsn_2024 AS (\\r\\n  SELECT \\r\\n    nu_cnpj_matriz AS nu_cnpj,\\r\\n    nu_per_ref AS periodo,\\r\\n    vl_rec_bruta,\\r\\n    vl_rec_bruta_em_12m,\\r\\n    vl_rec_bruta_no_ano,\\r\\n    vl_icms_sc,\\r\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando receita bruta e ICMS s\\u00e3o zero)\\r\\n    CASE WHEN vl_rec_bruta = 0 AND vl_icms_sc = 0\\r\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\r\\n  FROM usr_sat_ods.vw_sna_pgdasd_grupo_empresarial\\r\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n),\\r\\n\\r\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para SIMPLES NACIONAL\\r\\nestatisticas_simples AS (\\r\\n  SELECT\\r\\n    mp.cnpj,\\r\\n    mp.cnpj_limpo,\\r\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\r\\n    COUNT(DISTINCT s.periodo) AS periodos_declarados,\\r\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT s.periodo) AS periodos_omissos,\\r\\n    SUM(COALESCE(s.declaracao_zerada, 0)) AS periodos_zerados\\r\\n  FROM matriz_cnpj_periodo mp\\r\\n  LEFT JOIN sn_2024 s\\r\\n    ON REGEXP_REPLACE(TRIM(CAST(s.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\r\\n    AND s.periodo = mp.periodo\\r\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\r\\n),\\r\\n\\r\\n-- Agrega\\u00e7\\u00e3o de dados Simples Nacional por CNPJ\\r\\nsn_consolidado AS (\\r\\n  SELECT \\r\\n    nu_cnpj,\\r\\n    SUM(vl_rec_bruta) AS total_vl_rec_bruta,\\r\\n    MAX(vl_rec_bruta_em_12m) AS max_vl_rec_bruta_em_12m,\\r\\n    SUM(vl_rec_bruta_no_ano) AS total_vl_rec_bruta_no_ano,\\r\\n    SUM(vl_icms_sc) AS total_vl_icms_sc\\r\\n  FROM sn_2024\\r\\n  GROUP BY nu_cnpj\\r\\n),\\r\\n\\r\\n-- Dados de NF-e (usando o CNPJ do emitente)\\r\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\r\\nnfe_dados AS (\\r\\n  SELECT \\r\\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\r\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\r\\n  FROM nfe.nfe\\r\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\r\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\r\\n)\\r\\n\\r\\nSELECT\\r\\n  -- Colunas principais do contribuinte\\r\\n  c.nm_contador,\\r\\n  c.nu_cnpj,\\r\\n  c.nm_razao_social,\\r\\n  c.nm_fantasia,\\r\\n  c.nm_reg_apuracao,\\r\\n  cb.cnpj AS cnpj_base,\\r\\n  \\r\\n  -- Colunas espec\\u00edficas de SIMPLES NACIONAL\\r\\n  sn.total_vl_rec_bruta,\\r\\n  sn.max_vl_rec_bruta_em_12m,\\r\\n  sn.total_vl_rec_bruta_no_ano,\\r\\n  sn.total_vl_icms_sc,\\r\\n  \\r\\n  -- Auditoria\\r\\n  aes.dt_constituicao_empresa,\\r\\n  \\r\\n  -- Dados de NFe\\r\\n  nfi.total_nfes_emitidas,\\r\\n  \\r\\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\r\\n  es.periodos_omissos,\\r\\n  es.periodos_zerados,\\r\\n  es.total_periodos,\\r\\n  es.periodos_declarados\\r\\n  \\r\\nFROM teste.cancel_cnpj cb\\r\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n\\r\\nLEFT JOIN sn_consolidado sn\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(sn.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN nfe_dados nfi\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN estatisticas_simples es\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = es.cnpj_limpo\\r\\n  \\r\\nWHERE c.nm_reg_apuracao = 'SIMPLES NACIONAL' OR c.nm_reg_apuracao IS NULL;\", \"statementsList\": [\"-- 1. Dropar as tabelas existentes\\r\\nDROP TABLE IF EXISTS teste.cancel_zero_normal;\", \"\\r\\nDROP TABLE IF EXISTS teste.cancel_zero_simples;\", \"\\r\\n\\r\\n-- 2. Criar tabela para NORMAL\\r\\nCREATE TABLE teste.cancel_zero_normal AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Per\\u00edodos a serem analisados\\r\\nperiodos AS (\\r\\n  SELECT periodo \\r\\n  FROM (\\r\\n    SELECT 202502 AS periodo UNION ALL\\r\\n    SELECT 202501 AS periodo UNION ALL\\r\\n    SELECT 202412 AS periodo UNION ALL\\r\\n    SELECT 202411 AS periodo UNION ALL\\r\\n    SELECT 202410 AS periodo UNION ALL\\r\\n    SELECT 202409 AS periodo UNION ALL\\r\\n    SELECT 202408 AS periodo UNION ALL\\r\\n    SELECT 202407 AS periodo\\r\\n  ) p\\r\\n),\\r\\n\\r\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\r\\nmatriz_cnpj_periodo AS (\\r\\n  SELECT \\r\\n    cb.cnpj,\\r\\n    cb.cnpj_limpo,\\r\\n    p.periodo\\r\\n  FROM cnpj_base cb\\r\\n  CROSS JOIN periodos p\\r\\n),\\r\\n\\r\\n-- Agrega dados da usr_sat_ods.ods_decl_dime_raw (para NORMAL)\\r\\ndime_2024 AS (\\r\\n  SELECT \\r\\n    NU_CNPJ,\\r\\n    nu_per_ref AS periodo,\\r\\n    VL_RECEITA_BRUTA,\\r\\n    VL_FATURAMENTO,\\r\\n    VL_TOT_CRED,\\r\\n    VL_TOT_DEB,\\r\\n    VL_DEB_RECOLHER,\\r\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando todos os valores importantes s\\u00e3o zero)\\r\\n    CASE WHEN VL_RECEITA_BRUTA = 0 AND VL_FATURAMENTO = 0 AND VL_TOT_CRED = 0 AND VL_TOT_DEB = 0 AND VL_DEB_RECOLHER = 0\\r\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\r\\n  FROM usr_sat_ods.ods_decl_dime_raw\\r\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n),\\r\\n\\r\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para NORMAL\\r\\nestatisticas_normal AS (\\r\\n  SELECT\\r\\n    mp.cnpj,\\r\\n    mp.cnpj_limpo,\\r\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\r\\n    COUNT(DISTINCT d.periodo) AS periodos_declarados,\\r\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT d.periodo) AS periodos_omissos,\\r\\n    SUM(COALESCE(d.declaracao_zerada, 0)) AS periodos_zerados\\r\\n  FROM matriz_cnpj_periodo mp\\r\\n  LEFT JOIN dime_2024 d\\r\\n    ON REGEXP_REPLACE(TRIM(CAST(d.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\r\\n    AND d.periodo = mp.periodo\\r\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\r\\n),\\r\\n\\r\\n-- Agrega\\u00e7\\u00e3o de dados DIME por CNPJ para NORMAL\\r\\ndime_consolidado AS (\\r\\n  SELECT \\r\\n    NU_CNPJ,\\r\\n    SUM(VL_RECEITA_BRUTA) AS total_vl_receita_bruta,\\r\\n    SUM(VL_FATURAMENTO) AS total_vl_faturamento,\\r\\n    SUM(VL_TOT_CRED) AS total_vl_tot_cred,\\r\\n    SUM(VL_TOT_DEB) AS total_vl_tot_deb,\\r\\n    SUM(VL_DEB_RECOLHER) AS total_vl_deb_recolher\\r\\n  FROM dime_2024\\r\\n  GROUP BY NU_CNPJ\\r\\n),\\r\\n\\r\\n-- Dados de NF-e (usando o CNPJ do emitente)\\r\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\r\\nnfe_dados AS (\\r\\n  SELECT \\r\\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\r\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\r\\n  FROM nfe.nfe\\r\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\r\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\r\\n)\\r\\n\\r\\nSELECT\\r\\n  -- Colunas principais do contribuinte\\r\\n  c.nm_contador,\\r\\n  c.nu_cnpj,\\r\\n  c.nm_razao_social,\\r\\n  c.nm_fantasia,\\r\\n  c.nm_reg_apuracao,\\r\\n  cb.cnpj AS cnpj_base,\\r\\n  \\r\\n  -- Colunas espec\\u00edficas de NORMAL\\r\\n  d.total_vl_faturamento,\\r\\n  d.total_vl_receita_bruta,\\r\\n  d.total_vl_tot_cred,\\r\\n  d.total_vl_tot_deb,\\r\\n  d.total_vl_deb_recolher,\\r\\n  \\r\\n  -- Auditoria\\r\\n  aes.dt_constituicao_empresa,\\r\\n  \\r\\n  -- Dados de NFe\\r\\n  nfi.total_nfes_emitidas,\\r\\n  \\r\\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\r\\n  en.periodos_omissos,\\r\\n  en.periodos_zerados,\\r\\n  en.total_periodos,\\r\\n  en.periodos_declarados\\r\\n  \\r\\nFROM teste.cancel_cnpj cb\\r\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n\\r\\nLEFT JOIN dime_consolidado d\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(d.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN nfe_dados nfi\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN estatisticas_normal en\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = en.cnpj_limpo\\r\\n  \\r\\nWHERE c.nm_reg_apuracao = 'NORMAL' OR c.nm_reg_apuracao IS NULL;\", \"\\r\\n\\r\\n\\r\\n-- 3. Criar tabela para SIMPLES NACIONAL\\r\\nCREATE TABLE teste.cancel_zero_simples AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Per\\u00edodos a serem analisados\\r\\nperiodos AS (\\r\\n  SELECT periodo \\r\\n  FROM (\\r\\n    SELECT 202502 AS periodo UNION ALL\\r\\n    SELECT 202501 AS periodo UNION ALL\\r\\n    SELECT 202412 AS periodo UNION ALL\\r\\n    SELECT 202411 AS periodo UNION ALL\\r\\n    SELECT 202410 AS periodo UNION ALL\\r\\n    SELECT 202409 AS periodo UNION ALL\\r\\n    SELECT 202408 AS periodo UNION ALL\\r\\n    SELECT 202407 AS periodo\\r\\n  ) p\\r\\n),\\r\\n\\r\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\r\\nmatriz_cnpj_periodo AS (\\r\\n  SELECT \\r\\n    cb.cnpj,\\r\\n    cb.cnpj_limpo,\\r\\n    p.periodo\\r\\n  FROM cnpj_base cb\\r\\n  CROSS JOIN periodos p\\r\\n),\\r\\n\\r\\n-- Agrega dados do Simples Nacional\\r\\nsn_2024 AS (\\r\\n  SELECT \\r\\n    nu_cnpj_matriz AS nu_cnpj,\\r\\n    nu_per_ref AS periodo,\\r\\n    vl_rec_bruta,\\r\\n    vl_rec_bruta_em_12m,\\r\\n    vl_rec_bruta_no_ano,\\r\\n    vl_icms_sc,\\r\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando receita bruta e ICMS s\\u00e3o zero)\\r\\n    CASE WHEN vl_rec_bruta = 0 AND vl_icms_sc = 0\\r\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\r\\n  FROM usr_sat_ods.vw_sna_pgdasd_grupo_empresarial\\r\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n),\\r\\n\\r\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para SIMPLES NACIONAL\\r\\nestatisticas_simples AS (\\r\\n  SELECT\\r\\n    mp.cnpj,\\r\\n    mp.cnpj_limpo,\\r\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\r\\n    COUNT(DISTINCT s.periodo) AS periodos_declarados,\\r\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT s.periodo) AS periodos_omissos,\\r\\n    SUM(COALESCE(s.declaracao_zerada, 0)) AS periodos_zerados\\r\\n  FROM matriz_cnpj_periodo mp\\r\\n  LEFT JOIN sn_2024 s\\r\\n    ON REGEXP_REPLACE(TRIM(CAST(s.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\r\\n    AND s.periodo = mp.periodo\\r\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\r\\n),\\r\\n\\r\\n-- Agrega\\u00e7\\u00e3o de dados Simples Nacional por CNPJ\\r\\nsn_consolidado AS (\\r\\n  SELECT \\r\\n    nu_cnpj,\\r\\n    SUM(vl_rec_bruta) AS total_vl_rec_bruta,\\r\\n    MAX(vl_rec_bruta_em_12m) AS max_vl_rec_bruta_em_12m,\\r\\n    SUM(vl_rec_bruta_no_ano) AS total_vl_rec_bruta_no_ano,\\r\\n    SUM(vl_icms_sc) AS total_vl_icms_sc\\r\\n  FROM sn_2024\\r\\n  GROUP BY nu_cnpj\\r\\n),\\r\\n\\r\\n-- Dados de NF-e (usando o CNPJ do emitente)\\r\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\r\\nnfe_dados AS (\\r\\n  SELECT \\r\\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\r\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\r\\n  FROM nfe.nfe\\r\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\r\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\r\\n)\\r\\n\\r\\nSELECT\\r\\n  -- Colunas principais do contribuinte\\r\\n  c.nm_contador,\\r\\n  c.nu_cnpj,\\r\\n  c.nm_razao_social,\\r\\n  c.nm_fantasia,\\r\\n  c.nm_reg_apuracao,\\r\\n  cb.cnpj AS cnpj_base,\\r\\n  \\r\\n  -- Colunas espec\\u00edficas de SIMPLES NACIONAL\\r\\n  sn.total_vl_rec_bruta,\\r\\n  sn.max_vl_rec_bruta_em_12m,\\r\\n  sn.total_vl_rec_bruta_no_ano,\\r\\n  sn.total_vl_icms_sc,\\r\\n  \\r\\n  -- Auditoria\\r\\n  aes.dt_constituicao_empresa,\\r\\n  \\r\\n  -- Dados de NFe\\r\\n  nfi.total_nfes_emitidas,\\r\\n  \\r\\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\r\\n  es.periodos_omissos,\\r\\n  es.periodos_zerados,\\r\\n  es.total_periodos,\\r\\n  es.periodos_declarados\\r\\n  \\r\\nFROM teste.cancel_cnpj cb\\r\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n\\r\\nLEFT JOIN sn_consolidado sn\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(sn.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN nfe_dados nfi\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN estatisticas_simples es\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = es.cnpj_limpo\\r\\n  \\r\\nWHERE c.nm_reg_apuracao = 'SIMPLES NACIONAL' OR c.nm_reg_apuracao IS NULL;\"], \"aceSize\": 100, \"status\": \"available\", \"statusForButtons\": \"executed\", \"properties\": {\"settings\": []}, \"viewSettings\": {\"placeHolder\": \"Exemplo: SELECT * FROM tablename ou pressione CTRL + espa\\u00e7o\", \"sqlDialect\": true}, \"variables\": [], \"hasCurlyBracketParameters\": true, \"variableNames\": [], \"variableValues\": {}, \"statement\": \"-- 1. Dropar as tabelas existentes\\r\\nDROP TABLE IF EXISTS teste.cancel_zero_normal;\\r\\nDROP TABLE IF EXISTS teste.cancel_zero_simples;\\r\\n\\r\\n-- 2. Criar tabela para NORMAL\\r\\nCREATE TABLE teste.cancel_zero_normal AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Per\\u00edodos a serem analisados\\r\\nperiodos AS (\\r\\n  SELECT periodo \\r\\n  FROM (\\r\\n    SELECT 202502 AS periodo UNION ALL\\r\\n    SELECT 202501 AS periodo UNION ALL\\r\\n    SELECT 202412 AS periodo UNION ALL\\r\\n    SELECT 202411 AS periodo UNION ALL\\r\\n    SELECT 202410 AS periodo UNION ALL\\r\\n    SELECT 202409 AS periodo UNION ALL\\r\\n    SELECT 202408 AS periodo UNION ALL\\r\\n    SELECT 202407 AS periodo\\r\\n  ) p\\r\\n),\\r\\n\\r\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\r\\nmatriz_cnpj_periodo AS (\\r\\n  SELECT \\r\\n    cb.cnpj,\\r\\n    cb.cnpj_limpo,\\r\\n    p.periodo\\r\\n  FROM cnpj_base cb\\r\\n  CROSS JOIN periodos p\\r\\n),\\r\\n\\r\\n-- Agrega dados da usr_sat_ods.ods_decl_dime_raw (para NORMAL)\\r\\ndime_2024 AS (\\r\\n  SELECT \\r\\n    NU_CNPJ,\\r\\n    nu_per_ref AS periodo,\\r\\n    VL_RECEITA_BRUTA,\\r\\n    VL_FATURAMENTO,\\r\\n    VL_TOT_CRED,\\r\\n    VL_TOT_DEB,\\r\\n    VL_DEB_RECOLHER,\\r\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando todos os valores importantes s\\u00e3o zero)\\r\\n    CASE WHEN VL_RECEITA_BRUTA = 0 AND VL_FATURAMENTO = 0 AND VL_TOT_CRED = 0 AND VL_TOT_DEB = 0 AND VL_DEB_RECOLHER = 0\\r\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\r\\n  FROM usr_sat_ods.ods_decl_dime_raw\\r\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n),\\r\\n\\r\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para NORMAL\\r\\nestatisticas_normal AS (\\r\\n  SELECT\\r\\n    mp.cnpj,\\r\\n    mp.cnpj_limpo,\\r\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\r\\n    COUNT(DISTINCT d.periodo) AS periodos_declarados,\\r\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT d.periodo) AS periodos_omissos,\\r\\n    SUM(COALESCE(d.declaracao_zerada, 0)) AS periodos_zerados\\r\\n  FROM matriz_cnpj_periodo mp\\r\\n  LEFT JOIN dime_2024 d\\r\\n    ON REGEXP_REPLACE(TRIM(CAST(d.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\r\\n    AND d.periodo = mp.periodo\\r\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\r\\n),\\r\\n\\r\\n-- Agrega\\u00e7\\u00e3o de dados DIME por CNPJ para NORMAL\\r\\ndime_consolidado AS (\\r\\n  SELECT \\r\\n    NU_CNPJ,\\r\\n    SUM(VL_RECEITA_BRUTA) AS total_vl_receita_bruta,\\r\\n    SUM(VL_FATURAMENTO) AS total_vl_faturamento,\\r\\n    SUM(VL_TOT_CRED) AS total_vl_tot_cred,\\r\\n    SUM(VL_TOT_DEB) AS total_vl_tot_deb,\\r\\n    SUM(VL_DEB_RECOLHER) AS total_vl_deb_recolher\\r\\n  FROM dime_2024\\r\\n  GROUP BY NU_CNPJ\\r\\n),\\r\\n\\r\\n-- Dados de NF-e (usando o CNPJ do emitente)\\r\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\r\\nnfe_dados AS (\\r\\n  SELECT \\r\\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\r\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\r\\n  FROM nfe.nfe\\r\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\r\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\r\\n)\\r\\n\\r\\nSELECT\\r\\n  -- Colunas principais do contribuinte\\r\\n  c.nm_contador,\\r\\n  c.nu_cnpj,\\r\\n  c.nm_razao_social,\\r\\n  c.nm_fantasia,\\r\\n  c.nm_reg_apuracao,\\r\\n  cb.cnpj AS cnpj_base,\\r\\n  \\r\\n  -- Colunas espec\\u00edficas de NORMAL\\r\\n  d.total_vl_faturamento,\\r\\n  d.total_vl_receita_bruta,\\r\\n  d.total_vl_tot_cred,\\r\\n  d.total_vl_tot_deb,\\r\\n  d.total_vl_deb_recolher,\\r\\n  \\r\\n  -- Auditoria\\r\\n  aes.dt_constituicao_empresa,\\r\\n  \\r\\n  -- Dados de NFe\\r\\n  nfi.total_nfes_emitidas,\\r\\n  \\r\\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\r\\n  en.periodos_omissos,\\r\\n  en.periodos_zerados,\\r\\n  en.total_periodos,\\r\\n  en.periodos_declarados\\r\\n  \\r\\nFROM teste.cancel_cnpj cb\\r\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n\\r\\nLEFT JOIN dime_consolidado d\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(d.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN nfe_dados nfi\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN estatisticas_normal en\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = en.cnpj_limpo\\r\\n  \\r\\nWHERE c.nm_reg_apuracao = 'NORMAL' OR c.nm_reg_apuracao IS NULL;\\r\\n\\r\\n\\r\\n-- 3. Criar tabela para SIMPLES NACIONAL\\r\\nCREATE TABLE teste.cancel_zero_simples AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Per\\u00edodos a serem analisados\\r\\nperiodos AS (\\r\\n  SELECT periodo \\r\\n  FROM (\\r\\n    SELECT 202502 AS periodo UNION ALL\\r\\n    SELECT 202501 AS periodo UNION ALL\\r\\n    SELECT 202412 AS periodo UNION ALL\\r\\n    SELECT 202411 AS periodo UNION ALL\\r\\n    SELECT 202410 AS periodo UNION ALL\\r\\n    SELECT 202409 AS periodo UNION ALL\\r\\n    SELECT 202408 AS periodo UNION ALL\\r\\n    SELECT 202407 AS periodo\\r\\n  ) p\\r\\n),\\r\\n\\r\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\r\\nmatriz_cnpj_periodo AS (\\r\\n  SELECT \\r\\n    cb.cnpj,\\r\\n    cb.cnpj_limpo,\\r\\n    p.periodo\\r\\n  FROM cnpj_base cb\\r\\n  CROSS JOIN periodos p\\r\\n),\\r\\n\\r\\n-- Agrega dados do Simples Nacional\\r\\nsn_2024 AS (\\r\\n  SELECT \\r\\n    nu_cnpj_matriz AS nu_cnpj,\\r\\n    nu_per_ref AS periodo,\\r\\n    vl_rec_bruta,\\r\\n    vl_rec_bruta_em_12m,\\r\\n    vl_rec_bruta_no_ano,\\r\\n    vl_icms_sc,\\r\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando receita bruta e ICMS s\\u00e3o zero)\\r\\n    CASE WHEN vl_rec_bruta = 0 AND vl_icms_sc = 0\\r\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\r\\n  FROM usr_sat_ods.vw_sna_pgdasd_grupo_empresarial\\r\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n),\\r\\n\\r\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para SIMPLES NACIONAL\\r\\nestatisticas_simples AS (\\r\\n  SELECT\\r\\n    mp.cnpj,\\r\\n    mp.cnpj_limpo,\\r\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\r\\n    COUNT(DISTINCT s.periodo) AS periodos_declarados,\\r\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT s.periodo) AS periodos_omissos,\\r\\n    SUM(COALESCE(s.declaracao_zerada, 0)) AS periodos_zerados\\r\\n  FROM matriz_cnpj_periodo mp\\r\\n  LEFT JOIN sn_2024 s\\r\\n    ON REGEXP_REPLACE(TRIM(CAST(s.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\r\\n    AND s.periodo = mp.periodo\\r\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\r\\n),\\r\\n\\r\\n-- Agrega\\u00e7\\u00e3o de dados Simples Nacional por CNPJ\\r\\nsn_consolidado AS (\\r\\n  SELECT \\r\\n    nu_cnpj,\\r\\n    SUM(vl_rec_bruta) AS total_vl_rec_bruta,\\r\\n    MAX(vl_rec_bruta_em_12m) AS max_vl_rec_bruta_em_12m,\\r\\n    SUM(vl_rec_bruta_no_ano) AS total_vl_rec_bruta_no_ano,\\r\\n    SUM(vl_icms_sc) AS total_vl_icms_sc\\r\\n  FROM sn_2024\\r\\n  GROUP BY nu_cnpj\\r\\n),\\r\\n\\r\\n-- Dados de NF-e (usando o CNPJ do emitente)\\r\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\r\\nnfe_dados AS (\\r\\n  SELECT \\r\\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\r\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\r\\n  FROM nfe.nfe\\r\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\r\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\r\\n)\\r\\n\\r\\nSELECT\\r\\n  -- Colunas principais do contribuinte\\r\\n  c.nm_contador,\\r\\n  c.nu_cnpj,\\r\\n  c.nm_razao_social,\\r\\n  c.nm_fantasia,\\r\\n  c.nm_reg_apuracao,\\r\\n  cb.cnpj AS cnpj_base,\\r\\n  \\r\\n  -- Colunas espec\\u00edficas de SIMPLES NACIONAL\\r\\n  sn.total_vl_rec_bruta,\\r\\n  sn.max_vl_rec_bruta_em_12m,\\r\\n  sn.total_vl_rec_bruta_no_ano,\\r\\n  sn.total_vl_icms_sc,\\r\\n  \\r\\n  -- Auditoria\\r\\n  aes.dt_constituicao_empresa,\\r\\n  \\r\\n  -- Dados de NFe\\r\\n  nfi.total_nfes_emitidas,\\r\\n  \\r\\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\r\\n  es.periodos_omissos,\\r\\n  es.periodos_zerados,\\r\\n  es.total_periodos,\\r\\n  es.periodos_declarados\\r\\n  \\r\\nFROM teste.cancel_cnpj cb\\r\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n\\r\\nLEFT JOIN sn_consolidado sn\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(sn.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN nfe_dados nfi\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN estatisticas_simples es\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = es.cnpj_limpo\\r\\n  \\r\\nWHERE c.nm_reg_apuracao = 'SIMPLES NACIONAL' OR c.nm_reg_apuracao IS NULL;\", \"result\": {\"id\": \"6f9cdb39-4c5d-f986-03d9-0253360c6928\", \"type\": \"table\", \"hasResultset\": true, \"handle\": {\"secret\": \"aZze3cJWTpuAL4u06/eikg==\", \"guid\": \"xzCdSwfFTI0AAAAArhrhuA==\", \"operation_type\": 0, \"has_result_set\": true, \"modified_row_count\": null, \"log_context\": null, \"session_guid\": \"984b6f311745cffa:2ddd378c7babe5a5\", \"session_id\": 14429, \"session_type\": \"impala\", \"statement_id\": 3, \"has_more_statements\": false, \"statements_count\": 4, \"previous_statement_hash\": \"e841970a74c1ffc54df78717c4e12225e3289f6bf53023364c2665d9\", \"start\": {\"row\": 149, \"column\": 0}, \"end\": {\"row\": 288, \"column\": 73}, \"statement\": \"-- 3. Criar tabela para SIMPLES NACIONAL\\nCREATE TABLE teste.cancel_zero_simples AS\\nWITH \\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\ncnpj_base AS (\\n  SELECT \\n    cnpj,\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\n  FROM teste.cancel_cnpj\\n),\\n\\n-- Per\\u00edodos a serem analisados\\nperiodos AS (\\n  SELECT periodo \\n  FROM (\\n    SELECT 202502 AS periodo UNION ALL\\n    SELECT 202501 AS periodo UNION ALL\\n    SELECT 202412 AS periodo UNION ALL\\n    SELECT 202411 AS periodo UNION ALL\\n    SELECT 202410 AS periodo UNION ALL\\n    SELECT 202409 AS periodo UNION ALL\\n    SELECT 202408 AS periodo UNION ALL\\n    SELECT 202407 AS periodo\\n  ) p\\n),\\n\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\nmatriz_cnpj_periodo AS (\\n  SELECT \\n    cb.cnpj,\\n    cb.cnpj_limpo,\\n    p.periodo\\n  FROM cnpj_base cb\\n  CROSS JOIN periodos p\\n),\\n\\n-- Agrega dados do Simples Nacional\\nsn_2024 AS (\\n  SELECT \\n    nu_cnpj_matriz AS nu_cnpj,\\n    nu_per_ref AS periodo,\\n    vl_rec_bruta,\\n    vl_rec_bruta_em_12m,\\n    vl_rec_bruta_no_ano,\\n    vl_icms_sc,\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando receita bruta e ICMS s\\u00e3o zero)\\n    CASE WHEN vl_rec_bruta = 0 AND vl_icms_sc = 0\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\n  FROM usr_sat_ods.vw_sna_pgdasd_grupo_empresarial\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\n),\\n\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para SIMPLES NACIONAL\\nestatisticas_simples AS (\\n  SELECT\\n    mp.cnpj,\\n    mp.cnpj_limpo,\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\n    COUNT(DISTINCT s.periodo) AS periodos_declarados,\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT s.periodo) AS periodos_omissos,\\n    SUM(COALESCE(s.declaracao_zerada, 0)) AS periodos_zerados\\n  FROM matriz_cnpj_periodo mp\\n  LEFT JOIN sn_2024 s\\n    ON REGEXP_REPLACE(TRIM(CAST(s.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\n    AND s.periodo = mp.periodo\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\n),\\n\\n-- Agrega\\u00e7\\u00e3o de dados Simples Nacional por CNPJ\\nsn_consolidado AS (\\n  SELECT \\n    nu_cnpj,\\n    SUM(vl_rec_bruta) AS total_vl_rec_bruta,\\n    MAX(vl_rec_bruta_em_12m) AS max_vl_rec_bruta_em_12m,\\n    SUM(vl_rec_bruta_no_ano) AS total_vl_rec_bruta_no_ano,\\n    SUM(vl_icms_sc) AS total_vl_icms_sc\\n  FROM sn_2024\\n  GROUP BY nu_cnpj\\n),\\n\\n-- Dados de NF-e (usando o CNPJ do emitente)\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\nnfe_dados AS (\\n  SELECT \\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\n  FROM nfe.nfe\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\n)\\n\\nSELECT\\n  -- Colunas principais do contribuinte\\n  c.nm_contador,\\n  c.nu_cnpj,\\n  c.nm_razao_social,\\n  c.nm_fantasia,\\n  c.nm_reg_apuracao,\\n  cb.cnpj AS cnpj_base,\\n  \\n  -- Colunas espec\\u00edficas de SIMPLES NACIONAL\\n  sn.total_vl_rec_bruta,\\n  sn.max_vl_rec_bruta_em_12m,\\n  sn.total_vl_rec_bruta_no_ano,\\n  sn.total_vl_icms_sc,\\n  \\n  -- Auditoria\\n  aes.dt_constituicao_empresa,\\n  \\n  -- Dados de NFe\\n  nfi.total_nfes_emitidas,\\n  \\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\n  es.periodos_omissos,\\n  es.periodos_zerados,\\n  es.total_periodos,\\n  es.periodos_declarados\\n  \\nFROM teste.cancel_cnpj cb\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\n\\nLEFT JOIN sn_consolidado sn\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\n     REGEXP_REPLACE(TRIM(CAST(sn.nu_cnpj AS STRING)), '[^0-9]', '')\\n     \\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\n     \\nLEFT JOIN nfe_dados nfi\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\n     \\nLEFT JOIN estatisticas_simples es\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = es.cnpj_limpo\\n  \\nWHERE c.nm_reg_apuracao = 'SIMPLES NACIONAL' OR c.nm_reg_apuracao IS NULL\"}, \"meta\": [], \"rows\": \"1\", \"hasMore\": false, \"statement_id\": 3, \"statement_range\": {\"start\": {\"row\": 149, \"column\": 0}, \"end\": {\"row\": 288, \"column\": 73}}, \"statements_count\": 4, \"metaFilter\": {\"query\": \"\", \"facets\": {}, \"text\": []}, \"isMetaFilterVisible\": false, \"filteredMetaChecked\": true, \"filteredColumnCount\": 1, \"filteredMeta\": [{\"type\": \"int\", \"name\": \"\", \"comment\": null, \"cssClass\": \"sort-numeric\", \"checked\": true, \"originalIndex\": 0}, {\"name\": \"summary\", \"type\": \"string\", \"comment\": null, \"cssClass\": \"sort-string\", \"checked\": true, \"originalIndex\": 1}], \"fetchedOnce\": false, \"startTime\": \"2025-04-10T17:53:14.179Z\", \"endTime\": \"2025-04-10T17:53:42.636Z\", \"executionTime\": 28457, \"data\": [], \"explanation\": \"\", \"logs\": \"\", \"logLines\": 24, \"hasSomeResults\": true}, \"showGrid\": true, \"showChart\": false, \"showLogs\": true, \"progress\": 0, \"jobs\": [], \"executeNextTimeout\": 30193, \"isLoading\": false, \"resultsKlass\": \"results impala\", \"errorsKlass\": \"results impala alert alert-error\", \"is_redacted\": false, \"chartType\": \"bars\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartLimits\": [5, 10, 25, 50, 100], \"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartYMulti\": [], \"chartData\": [], \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"hideStacked\": true, \"hasDataForChart\": false, \"previousChartOptions\": {\"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"chartYMulti\": [], \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null}, \"isResultSettingsVisible\": false, \"settingsVisible\": false, \"checkStatusTimeout\": 31639, \"getLogsTimeout\": 31661, \"topRisk\": null, \"suggestion\": \"\", \"hasSuggestion\": null, \"compatibilityCheckRunning\": false, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"compatibilitySourcePlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"compatibilityTargetPlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"showSqlAnalyzer\": false, \"wasBatchExecuted\": false, \"isReady\": true, \"lastExecuted\": 1744307593855, \"lastAceSelectionRowOffset\": 0, \"executingBlockingOperation\": null, \"showLongOperationWarning\": false, \"lastExecutedStatements\": \"-- 1. Dropar as tabelas existentes\\r\\nDROP TABLE IF EXISTS teste.cancel_zero_normal;\\r\\nDROP TABLE IF EXISTS teste.cancel_zero_simples;\\r\\n\\r\\n-- 2. Criar tabela para NORMAL\\r\\nCREATE TABLE teste.cancel_zero_normal AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Per\\u00edodos a serem analisados\\r\\nperiodos AS (\\r\\n  SELECT periodo \\r\\n  FROM (\\r\\n    SELECT 202502 AS periodo UNION ALL\\r\\n    SELECT 202501 AS periodo UNION ALL\\r\\n    SELECT 202412 AS periodo UNION ALL\\r\\n    SELECT 202411 AS periodo UNION ALL\\r\\n    SELECT 202410 AS periodo UNION ALL\\r\\n    SELECT 202409 AS periodo UNION ALL\\r\\n    SELECT 202408 AS periodo UNION ALL\\r\\n    SELECT 202407 AS periodo\\r\\n  ) p\\r\\n),\\r\\n\\r\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\r\\nmatriz_cnpj_periodo AS (\\r\\n  SELECT \\r\\n    cb.cnpj,\\r\\n    cb.cnpj_limpo,\\r\\n    p.periodo\\r\\n  FROM cnpj_base cb\\r\\n  CROSS JOIN periodos p\\r\\n),\\r\\n\\r\\n-- Agrega dados da usr_sat_ods.ods_decl_dime_raw (para NORMAL)\\r\\ndime_2024 AS (\\r\\n  SELECT \\r\\n    NU_CNPJ,\\r\\n    nu_per_ref AS periodo,\\r\\n    VL_RECEITA_BRUTA,\\r\\n    VL_FATURAMENTO,\\r\\n    VL_TOT_CRED,\\r\\n    VL_TOT_DEB,\\r\\n    VL_DEB_RECOLHER,\\r\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando todos os valores importantes s\\u00e3o zero)\\r\\n    CASE WHEN VL_RECEITA_BRUTA = 0 AND VL_FATURAMENTO = 0 AND VL_TOT_CRED = 0 AND VL_TOT_DEB = 0 AND VL_DEB_RECOLHER = 0\\r\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\r\\n  FROM usr_sat_ods.ods_decl_dime_raw\\r\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n),\\r\\n\\r\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para NORMAL\\r\\nestatisticas_normal AS (\\r\\n  SELECT\\r\\n    mp.cnpj,\\r\\n    mp.cnpj_limpo,\\r\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\r\\n    COUNT(DISTINCT d.periodo) AS periodos_declarados,\\r\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT d.periodo) AS periodos_omissos,\\r\\n    SUM(COALESCE(d.declaracao_zerada, 0)) AS periodos_zerados\\r\\n  FROM matriz_cnpj_periodo mp\\r\\n  LEFT JOIN dime_2024 d\\r\\n    ON REGEXP_REPLACE(TRIM(CAST(d.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\r\\n    AND d.periodo = mp.periodo\\r\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\r\\n),\\r\\n\\r\\n-- Agrega\\u00e7\\u00e3o de dados DIME por CNPJ para NORMAL\\r\\ndime_consolidado AS (\\r\\n  SELECT \\r\\n    NU_CNPJ,\\r\\n    SUM(VL_RECEITA_BRUTA) AS total_vl_receita_bruta,\\r\\n    SUM(VL_FATURAMENTO) AS total_vl_faturamento,\\r\\n    SUM(VL_TOT_CRED) AS total_vl_tot_cred,\\r\\n    SUM(VL_TOT_DEB) AS total_vl_tot_deb,\\r\\n    SUM(VL_DEB_RECOLHER) AS total_vl_deb_recolher\\r\\n  FROM dime_2024\\r\\n  GROUP BY NU_CNPJ\\r\\n),\\r\\n\\r\\n-- Dados de NF-e (usando o CNPJ do emitente)\\r\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\r\\nnfe_dados AS (\\r\\n  SELECT \\r\\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\r\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\r\\n  FROM nfe.nfe\\r\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\r\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\r\\n)\\r\\n\\r\\nSELECT\\r\\n  -- Colunas principais do contribuinte\\r\\n  c.nm_contador,\\r\\n  c.nu_cnpj,\\r\\n  c.nm_razao_social,\\r\\n  c.nm_fantasia,\\r\\n  c.nm_reg_apuracao,\\r\\n  cb.cnpj AS cnpj_base,\\r\\n  \\r\\n  -- Colunas espec\\u00edficas de NORMAL\\r\\n  d.total_vl_faturamento,\\r\\n  d.total_vl_receita_bruta,\\r\\n  d.total_vl_tot_cred,\\r\\n  d.total_vl_tot_deb,\\r\\n  d.total_vl_deb_recolher,\\r\\n  \\r\\n  -- Auditoria\\r\\n  aes.dt_constituicao_empresa,\\r\\n  \\r\\n  -- Dados de NFe\\r\\n  nfi.total_nfes_emitidas,\\r\\n  \\r\\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\r\\n  en.periodos_omissos,\\r\\n  en.periodos_zerados,\\r\\n  en.total_periodos,\\r\\n  en.periodos_declarados\\r\\n  \\r\\nFROM teste.cancel_cnpj cb\\r\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n\\r\\nLEFT JOIN dime_consolidado d\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(d.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN nfe_dados nfi\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN estatisticas_normal en\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = en.cnpj_limpo\\r\\n  \\r\\nWHERE c.nm_reg_apuracao = 'NORMAL' OR c.nm_reg_apuracao IS NULL;\\r\\n\\r\\n\\r\\n-- 3. Criar tabela para SIMPLES NACIONAL\\r\\nCREATE TABLE teste.cancel_zero_simples AS\\r\\nWITH \\r\\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\\r\\ncnpj_base AS (\\r\\n  SELECT \\r\\n    cnpj,\\r\\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\\r\\n  FROM teste.cancel_cnpj\\r\\n),\\r\\n\\r\\n-- Per\\u00edodos a serem analisados\\r\\nperiodos AS (\\r\\n  SELECT periodo \\r\\n  FROM (\\r\\n    SELECT 202502 AS periodo UNION ALL\\r\\n    SELECT 202501 AS periodo UNION ALL\\r\\n    SELECT 202412 AS periodo UNION ALL\\r\\n    SELECT 202411 AS periodo UNION ALL\\r\\n    SELECT 202410 AS periodo UNION ALL\\r\\n    SELECT 202409 AS periodo UNION ALL\\r\\n    SELECT 202408 AS periodo UNION ALL\\r\\n    SELECT 202407 AS periodo\\r\\n  ) p\\r\\n),\\r\\n\\r\\n-- Matriz de CNPJs e per\\u00edodos (todos os CNPJs para todos os per\\u00edodos)\\r\\nmatriz_cnpj_periodo AS (\\r\\n  SELECT \\r\\n    cb.cnpj,\\r\\n    cb.cnpj_limpo,\\r\\n    p.periodo\\r\\n  FROM cnpj_base cb\\r\\n  CROSS JOIN periodos p\\r\\n),\\r\\n\\r\\n-- Agrega dados do Simples Nacional\\r\\nsn_2024 AS (\\r\\n  SELECT \\r\\n    nu_cnpj_matriz AS nu_cnpj,\\r\\n    nu_per_ref AS periodo,\\r\\n    vl_rec_bruta,\\r\\n    vl_rec_bruta_em_12m,\\r\\n    vl_rec_bruta_no_ano,\\r\\n    vl_icms_sc,\\r\\n    -- Identificar declara\\u00e7\\u00f5es zeradas (quando receita bruta e ICMS s\\u00e3o zero)\\r\\n    CASE WHEN vl_rec_bruta = 0 AND vl_icms_sc = 0\\r\\n         THEN 1 ELSE 0 END AS declaracao_zerada\\r\\n  FROM usr_sat_ods.vw_sna_pgdasd_grupo_empresarial\\r\\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n),\\r\\n\\r\\n-- Estat\\u00edsticas de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas para SIMPLES NACIONAL\\r\\nestatisticas_simples AS (\\r\\n  SELECT\\r\\n    mp.cnpj,\\r\\n    mp.cnpj_limpo,\\r\\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\\r\\n    COUNT(DISTINCT s.periodo) AS periodos_declarados,\\r\\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT s.periodo) AS periodos_omissos,\\r\\n    SUM(COALESCE(s.declaracao_zerada, 0)) AS periodos_zerados\\r\\n  FROM matriz_cnpj_periodo mp\\r\\n  LEFT JOIN sn_2024 s\\r\\n    ON REGEXP_REPLACE(TRIM(CAST(s.NU_CNPJ AS STRING)), '[^0-9]', '') = mp.cnpj_limpo\\r\\n    AND s.periodo = mp.periodo\\r\\n  GROUP BY mp.cnpj, mp.cnpj_limpo\\r\\n),\\r\\n\\r\\n-- Agrega\\u00e7\\u00e3o de dados Simples Nacional por CNPJ\\r\\nsn_consolidado AS (\\r\\n  SELECT \\r\\n    nu_cnpj,\\r\\n    SUM(vl_rec_bruta) AS total_vl_rec_bruta,\\r\\n    MAX(vl_rec_bruta_em_12m) AS max_vl_rec_bruta_em_12m,\\r\\n    SUM(vl_rec_bruta_no_ano) AS total_vl_rec_bruta_no_ano,\\r\\n    SUM(vl_icms_sc) AS total_vl_icms_sc\\r\\n  FROM sn_2024\\r\\n  GROUP BY nu_cnpj\\r\\n),\\r\\n\\r\\n-- Dados de NF-e (usando o CNPJ do emitente)\\r\\n-- Filtramos apenas documentos de sa\\u00edda (tpnf = 1)\\r\\nnfe_dados AS (\\r\\n  SELECT \\r\\n    procnfe.nfe.infnfe.emit.cnpj AS emit_cnpj,\\r\\n    COUNT(DISTINCT chave) AS total_nfes_emitidas\\r\\n  FROM nfe.nfe\\r\\n  WHERE (ano_emissao * 100 + mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    AND procnfe.nfe.infnfe.ide.tpnf = 1\\r\\n  GROUP BY procnfe.nfe.infnfe.emit.cnpj\\r\\n)\\r\\n\\r\\nSELECT\\r\\n  -- Colunas principais do contribuinte\\r\\n  c.nm_contador,\\r\\n  c.nu_cnpj,\\r\\n  c.nm_razao_social,\\r\\n  c.nm_fantasia,\\r\\n  c.nm_reg_apuracao,\\r\\n  cb.cnpj AS cnpj_base,\\r\\n  \\r\\n  -- Colunas espec\\u00edficas de SIMPLES NACIONAL\\r\\n  sn.total_vl_rec_bruta,\\r\\n  sn.max_vl_rec_bruta_em_12m,\\r\\n  sn.total_vl_rec_bruta_no_ano,\\r\\n  sn.total_vl_icms_sc,\\r\\n  \\r\\n  -- Auditoria\\r\\n  aes.dt_constituicao_empresa,\\r\\n  \\r\\n  -- Dados de NFe\\r\\n  nfi.total_nfes_emitidas,\\r\\n  \\r\\n  -- Dados de omiss\\u00f5es e declara\\u00e7\\u00f5es zeradas\\r\\n  es.periodos_omissos,\\r\\n  es.periodos_zerados,\\r\\n  es.total_periodos,\\r\\n  es.periodos_declarados\\r\\n  \\r\\nFROM teste.cancel_cnpj cb\\r\\nLEFT JOIN usr_sat_ods.vw_cad_contrib c\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n\\r\\nLEFT JOIN sn_consolidado sn\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(sn.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN usr_sat_auditoria.aud_empresa_suspeita aes\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(aes.nu_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN nfe_dados nfi\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(c.nu_cnpj AS STRING)), '[^0-9]', '') = \\r\\n     REGEXP_REPLACE(TRIM(CAST(nfi.emit_cnpj AS STRING)), '[^0-9]', '')\\r\\n     \\r\\nLEFT JOIN estatisticas_simples es\\r\\n  ON REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '') = es.cnpj_limpo\\r\\n  \\r\\nWHERE c.nm_reg_apuracao = 'SIMPLES NACIONAL' OR c.nm_reg_apuracao IS NULL;\", \"lastExecutedSelectionRange\": {\"start\": {\"row\": 0, \"column\": 0}, \"end\": {\"row\": 288, \"column\": 74}}, \"formatEnabled\": true, \"isFetchingData\": false, \"isCanceling\": false, \"aceAutoExpand\": false, \"lastCheckStatusRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"query_status\\\": {\\\"status\\\": \\\"available\\\"}}\", \"responseJSON\": {\"status\": 0, \"query_status\": {\"status\": \"available\"}}, \"status\": 200, \"statusText\": \"OK\"}, \"lastGetLogsRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"logs\\\": \\\"Query 8d4cc5074b9d30c7:b8e11aae00000000 100% Complete (3865 out of 3865)\\\", \\\"progress\\\": 100, \\\"jobs\\\": [{\\\"name\\\": \\\"8d4cc5074b9d30c7:b8e11aae00000000\\\", \\\"url\\\": \\\"/hue/jobbrowser#!id=8d4cc5074b9d30c7:b8e11aae00000000\\\", \\\"started\\\": true, \\\"finished\\\": false, \\\"percentJob\\\": 100}], \\\"isFullLogs\\\": false}\", \"responseJSON\": {\"status\": 0, \"logs\": \"Query 8d4cc5074b9d30c7:b8e11aae00000000 100% Complete (3865 out of 3865)\", \"progress\": 100, \"jobs\": [{\"name\": \"8d4cc5074b9d30c7:b8e11aae00000000\", \"url\": \"/hue/jobbrowser#!id=8d4cc5074b9d30c7:b8e11aae00000000\", \"started\": true, \"finished\": false, \"percentJob\": 100}], \"isFullLogs\": false}, \"status\": 200, \"statusText\": \"OK\"}}], \"selectedSnippet\": \"impala\", \"creatingSessionLocks\": [], \"sessions\": [], \"directoryUuid\": \"\", \"dependentsCoordinator\": [], \"historyFilter\": \"\", \"historyFilterVisible\": false, \"loadingHistory\": false, \"historyInitialHeight\": 22283, \"forceHistoryInitialHeight\": false, \"historyCurrentPage\": 1, \"historyTotalPages\": 26, \"schedulerViewModel\": null, \"schedulerViewModelIsLoaded\": false, \"isBatchable\": true, \"isExecutingAll\": false, \"executingAllIndex\": 0, \"retryModalConfirm\": null, \"retryModalCancel\": null, \"canSave\": true, \"unloaded\": false, \"updateHistoryFailed\": false, \"viewSchedulerId\": \"\", \"loadingScheduler\": false, \"is_history\": false}",
    "extra": "",
    "search": "-- 1. Dropar as tabelas existentes\r\nDROP TABLE IF EXISTS teste.cancel_zero_normal;\r\nDROP TABLE IF EXISTS teste.cancel_zero_simples;\r\n\r\n-- 2. Criar tabela para NORMAL\r\nCREATE TABLE teste.cancel_zero_normal AS\r\nWITH \r\n-- Lista de CNPJs a serem processados (da tabela teste.cancel_cnpj)\r\ncnpj_base AS (\r\n  SELECT \r\n    cnpj,\r\n    REGEXP_REPLACE(TRIM(CAST(cnpj AS STRING)), '[^0-9]', '') AS cnpj_limpo\r\n  FROM teste.cancel_cnpj\r\n),\r\n\r\n-- PerÃ­odos a serem analisados\r\nperiodos AS (\r\n  SELECT periodo \r\n  FROM (\r\n    SELECT 202502 AS periodo UNION ALL\r\n    SELECT 202501 AS periodo UNION ALL\r\n    SELECT 202412 AS periodo UNION ALL\r\n    SELECT 202411 AS periodo UNION ALL\r\n    SELECT 202410 AS periodo UNION ALL\r\n    SELECT 202409 AS periodo UNION ALL\r\n    SELECT 202408 AS periodo UNION ALL\r\n    SELECT 202407 AS periodo\r\n  ) p\r\n),\r\n\r\n-- Matriz de CNPJs e perÃ­odos (todos os CNPJs para todos os perÃ­odos)\r\nmatriz_cnpj_periodo AS (\r\n  SELECT \r\n    cb.cnpj,\r\n    cb.cnpj_limpo,\r\n    p.periodo\r\n  FROM cnpj_base cb\r\n  CROSS JOIN periodos p\r\n),\r\n\r\n-- Agrega dados da usr_sat_ods.ods_decl_dime_raw (para NORMAL)\r\ndime_2024 AS (\r\n  SELECT \r\n    NU_CNPJ,\r\n    nu_per_ref AS periodo,\r\n    VL_RECEITA_BRUTA,\r\n    VL_FATURAMENTO,\r\n    VL_TOT_CRED,\r\n    VL_TOT_DEB,\r\n    VL_DEB_RECOLHER,\r\n    -- Identificar declaraÃ§Ãµes zeradas (quando todos os valores importantes sÃ£o zero)\r\n    CASE WHEN VL_RECEITA_BRUTA = 0 AND VL_FATURAMENTO = 0 AND VL_TOT_CRED = 0 AND VL_TOT_DEB = 0 AND VL_DEB_RECOLHER = 0\r\n         THEN 1 ELSE 0 END AS declaracao_zerada\r\n  FROM usr_sat_ods.ods_decl_dime_raw\r\n  WHERE nu_per_ref IN (202502,202501,202412,202411,202410,202409,202408,202407)\r\n),\r\n\r\n-- EstatÃ­sticas de omissÃµes e declaraÃ§Ãµes zeradas para NORMAL\r\nestatisticas_normal AS (\r\n  SELECT\r\n    mp.cnpj,\r\n    mp.cnpj_limpo,\r\n    COUNT(DISTINCT mp.periodo) AS total_periodos,\r\n    COUNT(DISTINCT d.periodo) AS periodos_declarados,\r\n    COUNT(DISTINCT mp.periodo) - COUNT(DISTINCT d.periodo) AS periodos_omissos,\r\n    SUM(COALESCE(d.decla",
    "last_modified": "2025-04-10T14:53:53.489",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "4021901f-ed7a-4fd2-b5bf-8647d6b477af",
      1,
      false
    ],
    "dependencies": []
  }
},
{
  "model": "desktop.document2",
  "pk": 115672,
  "fields": {
    "owner": [
      "tsevero"
    ],
    "name": "CANCEL: 5 SUSPEITAS",
    "description": "",
    "uuid": "e0e25b57-8f60-2b56-fdb0-37c9df809e45",
    "type": "query-impala",
    "connector": null,
    "data": "{\"id\": 115672, \"uuid\": \"e0e25b57-8f60-2b56-fdb0-37c9df809e45\", \"name\": \"CANCEL: 5 SUSPEITAS\", \"description\": \"\", \"type\": \"query-impala\", \"initialType\": \"impala\", \"coordinatorUuid\": null, \"isHistory\": true, \"isManaged\": true, \"parentSavedQueryUuid\": \"e0e25b57-8f60-2b56-fdb0-37c9df809e45\", \"isSaved\": true, \"onSuccessUrl\": null, \"pubSubUrl\": null, \"isPresentationModeDefault\": false, \"isPresentationMode\": false, \"isPresentationModeInitialized\": true, \"presentationSnippets\": {}, \"isHidingCode\": false, \"snippets\": [{\"id\": \"041c15c6-6527-4c15-8f10-691598b4b41e\", \"name\": \"Execute and watch\", \"type\": \"impala\", \"connector\": {\"name\": \"Impala\", \"type\": \"impala\", \"id\": \"impala\", \"displayName\": \"Impala\", \"buttonName\": \"Consulta\", \"tooltip\": \"Impala Query\", \"optimizer\": \"off\", \"page\": \"/editor/?type=impala\", \"is_sql\": true, \"is_batchable\": true, \"dialect\": \"impala\", \"dialect_properties\": {}}, \"isSqlDialect\": true, \"dialect\": \"impala\", \"isBatchable\": true, \"autocompleteSettings\": {\"temporaryOnly\": false}, \"aceCursorPosition\": {\"row\": 64, \"column\": 26}, \"errors\": [], \"aceErrorsHolder\": [], \"aceWarningsHolder\": [], \"aceErrors\": [], \"aceWarnings\": [], \"editorMode\": true, \"dbSelectionVisible\": false, \"showExecutionAnalysis\": false, \"namespace\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"status\": \"CREATED\", \"computes\": [{\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"type\": \"direct\", \"credentials\": {}}]}, \"compute\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"namespace\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"interface\": \"impala\", \"type\": \"direct\", \"options\": {}}, \"database\": \"usr_sat_auditoria\", \"currentQueryTab\": \"queryHistory\", \"pinnedContextTabs\": [], \"loadingQueries\": false, \"queriesHasErrors\": false, \"queriesCurrentPage\": 1, \"queriesTotalPages\": 3, \"queriesFilter\": \"\", \"queriesFilterVisible\": false, \"statementType\": \"text\", \"statementTypes\": [\"text\", \"file\"], \"statementPath\": \"\", \"externalStatementLoaded\": false, \"associatedDocumentLoading\": true, \"associatedDocumentUuid\": null, \"statement_raw\": \"--SELECT \\r\\n--    cnpj,\\r\\n--    cd_situacao_suspeita,\\r\\n--    qt_motivos,\\r\\n--    nu_score\\r\\n--FROM \\r\\n--    teste.cancel_suspeitas\\r\\n\\r\\n-- Cria\\u00e7\\u00e3o da tabela teste.cancel_suspeitas cruzando dados de cancel_cadastro e aud_empresa_sob_suspeita\\r\\nDROP TABLE IF EXISTS teste.cancel_suspeitas;\\r\\nCREATE TABLE teste.cancel_suspeitas AS\\r\\nSELECT \\r\\n    c.*,\\r\\n    s.cd_munic_na_conf,\\r\\n    s.nm_munic_na_conf,\\r\\n    s.cd_uf_na_conf,\\r\\n    s.nu_cep_na_conf,\\r\\n    s.tx_referencia_na_conf,\\r\\n    s.sn_salvou_endereco_na_conf,\\r\\n    s.sn_suspenso_dfe,\\r\\n    s.dt_suspensao_dfe AS dt_suspensao_dfe_suspeita,\\r\\n    s.cd_evento_suspensao_dfe,\\r\\n    s.qt_clientes_noteiras,\\r\\n    s.qt_fornecedoras_noteiras,\\r\\n    s.cd_situacao_suspeita,\\r\\n    s.dt_situacao_suspeita,\\r\\n    s.cd_tipo_confirmacao,\\r\\n    s.sn_cancelado_inex_inativ,\\r\\n    s.dt_inicio_protoc_cancelamento,\\r\\n    s.tx_obs_situacao_suspeita,\\r\\n    s.nu_score,\\r\\n    s.tp_variacao_score,\\r\\n    s.nu_score_ia,\\r\\n    s.tp_variacao_score_ia,\\r\\n    s.qt_motivos,\\r\\n    s.cd_usuario_responsavel,\\r\\n    s.dt_associacao_responsavel,\\r\\n    s.qt_meses_valores,\\r\\n    s.nu_per_inicial_valores,\\r\\n    s.nu_per_final_valores,\\r\\n    s.vl_total_nfes_saida,\\r\\n    s.vl_total_icms_nfes_saida,\\r\\n    s.vl_total_nfes_entrada,\\r\\n    s.vl_total_icms_nfes_entrada,\\r\\n    s.vl_total_arrecadacao_grupo,\\r\\n    s.id_setor_suspeito,\\r\\n    s.nu_per_ref_ini_vl_total_imp,\\r\\n    s.nu_per_ref_fim_vl_total_imp,\\r\\n    s.vl_total_imp_como_importador,\\r\\n    s.vl_total_imp_como_adquirente,\\r\\n    s.dt_processamento_big_data,\\r\\n    s.dt_inclusao AS dt_inclusao_suspeita,\\r\\n    s.dt_alteracao AS dt_alteracao_suspeita,\\r\\n    s.cd_usuario_alteracao,\\r\\n    s.sn_situacao_fiscal_ccc,\\r\\n    s.cd_tipo_confirmacao_anterior,\\r\\n    s.dt_confirmacao_anterior,\\r\\n    s.dt_reversao_confirmacao,\\r\\n    s.nm_fantasia_na_conf,\\r\\n    s.sn_salvou_telefones_na_conf,\\r\\n    s.nu_telefone_na_conf,\\r\\n    s.nu_telefone_corresp_na_conf\\r\\nFROM teste.cancel_cadastro c\\r\\nJOIN usr_sat_auditoria.aud_empresa_sob_suspeita s\\r\\n    ON c.cnpj = s.nu_cnpj;\", \"statementsList\": [\"--SELECT \\r\\n--    cnpj,\\r\\n--    cd_situacao_suspeita,\\r\\n--    qt_motivos,\\r\\n--    nu_score\\r\\n--FROM \\r\\n--    teste.cancel_suspeitas\\r\\n\\r\\n-- Cria\\u00e7\\u00e3o da tabela teste.cancel_suspeitas cruzando dados de cancel_cadastro e aud_empresa_sob_suspeita\\r\\nDROP TABLE IF EXISTS teste.cancel_suspeitas;\", \"\\r\\nCREATE TABLE teste.cancel_suspeitas AS\\r\\nSELECT \\r\\n    c.*,\\r\\n    s.cd_munic_na_conf,\\r\\n    s.nm_munic_na_conf,\\r\\n    s.cd_uf_na_conf,\\r\\n    s.nu_cep_na_conf,\\r\\n    s.tx_referencia_na_conf,\\r\\n    s.sn_salvou_endereco_na_conf,\\r\\n    s.sn_suspenso_dfe,\\r\\n    s.dt_suspensao_dfe AS dt_suspensao_dfe_suspeita,\\r\\n    s.cd_evento_suspensao_dfe,\\r\\n    s.qt_clientes_noteiras,\\r\\n    s.qt_fornecedoras_noteiras,\\r\\n    s.cd_situacao_suspeita,\\r\\n    s.dt_situacao_suspeita,\\r\\n    s.cd_tipo_confirmacao,\\r\\n    s.sn_cancelado_inex_inativ,\\r\\n    s.dt_inicio_protoc_cancelamento,\\r\\n    s.tx_obs_situacao_suspeita,\\r\\n    s.nu_score,\\r\\n    s.tp_variacao_score,\\r\\n    s.nu_score_ia,\\r\\n    s.tp_variacao_score_ia,\\r\\n    s.qt_motivos,\\r\\n    s.cd_usuario_responsavel,\\r\\n    s.dt_associacao_responsavel,\\r\\n    s.qt_meses_valores,\\r\\n    s.nu_per_inicial_valores,\\r\\n    s.nu_per_final_valores,\\r\\n    s.vl_total_nfes_saida,\\r\\n    s.vl_total_icms_nfes_saida,\\r\\n    s.vl_total_nfes_entrada,\\r\\n    s.vl_total_icms_nfes_entrada,\\r\\n    s.vl_total_arrecadacao_grupo,\\r\\n    s.id_setor_suspeito,\\r\\n    s.nu_per_ref_ini_vl_total_imp,\\r\\n    s.nu_per_ref_fim_vl_total_imp,\\r\\n    s.vl_total_imp_como_importador,\\r\\n    s.vl_total_imp_como_adquirente,\\r\\n    s.dt_processamento_big_data,\\r\\n    s.dt_inclusao AS dt_inclusao_suspeita,\\r\\n    s.dt_alteracao AS dt_alteracao_suspeita,\\r\\n    s.cd_usuario_alteracao,\\r\\n    s.sn_situacao_fiscal_ccc,\\r\\n    s.cd_tipo_confirmacao_anterior,\\r\\n    s.dt_confirmacao_anterior,\\r\\n    s.dt_reversao_confirmacao,\\r\\n    s.nm_fantasia_na_conf,\\r\\n    s.sn_salvou_telefones_na_conf,\\r\\n    s.nu_telefone_na_conf,\\r\\n    s.nu_telefone_corresp_na_conf\\r\\nFROM teste.cancel_cadastro c\\r\\nJOIN usr_sat_auditoria.aud_empresa_sob_suspeita s\\r\\n    ON c.cnpj = s.nu_cnpj;\"], \"aceSize\": 100, \"status\": \"failed\", \"statusForButtons\": \"executing\", \"properties\": {\"files\": [], \"functions\": [], \"settings\": []}, \"viewSettings\": {\"placeHolder\": \"Exemplo: SELECT * FROM tablename ou pressione CTRL + espa\\u00e7o\", \"sqlDialect\": true}, \"variables\": [], \"hasCurlyBracketParameters\": true, \"variableNames\": [], \"variableValues\": {}, \"statement\": \"--SELECT \\r\\n--    cnpj,\\r\\n--    cd_situacao_suspeita,\\r\\n--    qt_motivos,\\r\\n--    nu_score\\r\\n--FROM \\r\\n--    teste.cancel_suspeitas\\r\\n\\r\\n-- Cria\\u00e7\\u00e3o da tabela teste.cancel_suspeitas cruzando dados de cancel_cadastro e aud_empresa_sob_suspeita\\r\\nDROP TABLE IF EXISTS teste.cancel_suspeitas;\\r\\nCREATE TABLE teste.cancel_suspeitas AS\\r\\nSELECT \\r\\n    c.*,\\r\\n    s.cd_munic_na_conf,\\r\\n    s.nm_munic_na_conf,\\r\\n    s.cd_uf_na_conf,\\r\\n    s.nu_cep_na_conf,\\r\\n    s.tx_referencia_na_conf,\\r\\n    s.sn_salvou_endereco_na_conf,\\r\\n    s.sn_suspenso_dfe,\\r\\n    s.dt_suspensao_dfe AS dt_suspensao_dfe_suspeita,\\r\\n    s.cd_evento_suspensao_dfe,\\r\\n    s.qt_clientes_noteiras,\\r\\n    s.qt_fornecedoras_noteiras,\\r\\n    s.cd_situacao_suspeita,\\r\\n    s.dt_situacao_suspeita,\\r\\n    s.cd_tipo_confirmacao,\\r\\n    s.sn_cancelado_inex_inativ,\\r\\n    s.dt_inicio_protoc_cancelamento,\\r\\n    s.tx_obs_situacao_suspeita,\\r\\n    s.nu_score,\\r\\n    s.tp_variacao_score,\\r\\n    s.nu_score_ia,\\r\\n    s.tp_variacao_score_ia,\\r\\n    s.qt_motivos,\\r\\n    s.cd_usuario_responsavel,\\r\\n    s.dt_associacao_responsavel,\\r\\n    s.qt_meses_valores,\\r\\n    s.nu_per_inicial_valores,\\r\\n    s.nu_per_final_valores,\\r\\n    s.vl_total_nfes_saida,\\r\\n    s.vl_total_icms_nfes_saida,\\r\\n    s.vl_total_nfes_entrada,\\r\\n    s.vl_total_icms_nfes_entrada,\\r\\n    s.vl_total_arrecadacao_grupo,\\r\\n    s.id_setor_suspeito,\\r\\n    s.nu_per_ref_ini_vl_total_imp,\\r\\n    s.nu_per_ref_fim_vl_total_imp,\\r\\n    s.vl_total_imp_como_importador,\\r\\n    s.vl_total_imp_como_adquirente,\\r\\n    s.dt_processamento_big_data,\\r\\n    s.dt_inclusao AS dt_inclusao_suspeita,\\r\\n    s.dt_alteracao AS dt_alteracao_suspeita,\\r\\n    s.cd_usuario_alteracao,\\r\\n    s.sn_situacao_fiscal_ccc,\\r\\n    s.cd_tipo_confirmacao_anterior,\\r\\n    s.dt_confirmacao_anterior,\\r\\n    s.dt_reversao_confirmacao,\\r\\n    s.nm_fantasia_na_conf,\\r\\n    s.sn_salvou_telefones_na_conf,\\r\\n    s.nu_telefone_na_conf,\\r\\n    s.nu_telefone_corresp_na_conf\\r\\nFROM teste.cancel_cadastro c\\r\\nJOIN usr_sat_auditoria.aud_empresa_sob_suspeita s\\r\\n    ON c.cnpj = s.nu_cnpj;\", \"result\": {\"id\": \"053a946a-1347-0ece-5743-06ca1ec6b738\", \"type\": \"table\", \"hasResultset\": true, \"handle\": {\"secret\": \"Xc/sQCjfSyuxDKi2r362Ng==\", \"guid\": \"L21hVfQMRFEAAAAA0xqEmg==\", \"operation_type\": 0, \"has_result_set\": true, \"modified_row_count\": null, \"log_context\": null, \"session_guid\": \"894dc9596b6f6946:ac6a72fb32d740ab\", \"session_id\": 21630, \"session_type\": \"impala\", \"statement_id\": 1, \"has_more_statements\": false, \"statements_count\": 2, \"previous_statement_hash\": \"b52b636191f032e0843499725afc0fc3c3b9b3dcea31e5f6a965e3f0\", \"start\": {\"row\": 10, \"column\": 0}, \"end\": {\"row\": 64, \"column\": 25}, \"statement\": \"CREATE TABLE teste.cancel_suspeitas AS\\nSELECT \\n    c.*,\\n    s.cd_munic_na_conf,\\n    s.nm_munic_na_conf,\\n    s.cd_uf_na_conf,\\n    s.nu_cep_na_conf,\\n    s.tx_referencia_na_conf,\\n    s.sn_salvou_endereco_na_conf,\\n    s.sn_suspenso_dfe,\\n    s.dt_suspensao_dfe AS dt_suspensao_dfe_suspeita,\\n    s.cd_evento_suspensao_dfe,\\n    s.qt_clientes_noteiras,\\n    s.qt_fornecedoras_noteiras,\\n    s.cd_situacao_suspeita,\\n    s.dt_situacao_suspeita,\\n    s.cd_tipo_confirmacao,\\n    s.sn_cancelado_inex_inativ,\\n    s.dt_inicio_protoc_cancelamento,\\n    s.tx_obs_situacao_suspeita,\\n    s.nu_score,\\n    s.tp_variacao_score,\\n    s.nu_score_ia,\\n    s.tp_variacao_score_ia,\\n    s.qt_motivos,\\n    s.cd_usuario_responsavel,\\n    s.dt_associacao_responsavel,\\n    s.qt_meses_valores,\\n    s.nu_per_inicial_valores,\\n    s.nu_per_final_valores,\\n    s.vl_total_nfes_saida,\\n    s.vl_total_icms_nfes_saida,\\n    s.vl_total_nfes_entrada,\\n    s.vl_total_icms_nfes_entrada,\\n    s.vl_total_arrecadacao_grupo,\\n    s.id_setor_suspeito,\\n    s.nu_per_ref_ini_vl_total_imp,\\n    s.nu_per_ref_fim_vl_total_imp,\\n    s.vl_total_imp_como_importador,\\n    s.vl_total_imp_como_adquirente,\\n    s.dt_processamento_big_data,\\n    s.dt_inclusao AS dt_inclusao_suspeita,\\n    s.dt_alteracao AS dt_alteracao_suspeita,\\n    s.cd_usuario_alteracao,\\n    s.sn_situacao_fiscal_ccc,\\n    s.cd_tipo_confirmacao_anterior,\\n    s.dt_confirmacao_anterior,\\n    s.dt_reversao_confirmacao,\\n    s.nm_fantasia_na_conf,\\n    s.sn_salvou_telefones_na_conf,\\n    s.nu_telefone_na_conf,\\n    s.nu_telefone_corresp_na_conf\\nFROM teste.cancel_cadastro c\\nJOIN usr_sat_auditoria.aud_empresa_sob_suspeita s\\n    ON c.cnpj = s.nu_cnpj\"}, \"meta\": [], \"rows\": null, \"hasMore\": false, \"statement_id\": 1, \"statement_range\": {\"start\": {\"row\": 0, \"column\": 0}, \"end\": {\"row\": 0, \"column\": 0}}, \"statements_count\": 2, \"metaFilter\": {\"query\": \"\", \"facets\": {}, \"text\": []}, \"isMetaFilterVisible\": false, \"filteredMetaChecked\": true, \"filteredColumnCount\": -1, \"filteredMeta\": [], \"fetchedOnce\": false, \"startTime\": \"2025-10-15T17:58:56.266Z\", \"endTime\": \"2025-10-15T17:58:56.266Z\", \"executionTime\": 0, \"data\": [], \"explanation\": \"\", \"logs\": \"\", \"logLines\": 0, \"hasSomeResults\": true}, \"showGrid\": true, \"showChart\": false, \"showLogs\": true, \"progress\": 0, \"jobs\": [], \"executeNextTimeout\": 1342, \"isLoading\": false, \"resultsKlass\": \"results impala\", \"errorsKlass\": \"results impala alert alert-error\", \"is_redacted\": false, \"chartType\": \"bars\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartLimits\": [5, 10, 25, 50, 100], \"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartYMulti\": [], \"chartData\": [], \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"hideStacked\": true, \"hasDataForChart\": false, \"previousChartOptions\": {\"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"chartYMulti\": [], \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null}, \"isResultSettingsVisible\": false, \"settingsVisible\": false, \"checkStatusTimeout\": null, \"getLogsTimeout\": null, \"topRisk\": null, \"suggestion\": \"\", \"hasSuggestion\": null, \"compatibilityCheckRunning\": false, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"compatibilitySourcePlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"compatibilityTargetPlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"showSqlAnalyzer\": false, \"wasBatchExecuted\": false, \"isReady\": true, \"lastExecuted\": 1760551136255, \"lastAceSelectionRowOffset\": 0, \"executingBlockingOperation\": null, \"showLongOperationWarning\": false, \"lastExecutedStatements\": \"--SELECT \\r\\n--    cnpj,\\r\\n--    cd_situacao_suspeita,\\r\\n--    qt_motivos,\\r\\n--    nu_score\\r\\n--FROM \\r\\n--    teste.cancel_suspeitas\\r\\n\\r\\n-- Cria\\u00e7\\u00e3o da tabela teste.cancel_suspeitas cruzando dados de cancel_cadastro e aud_empresa_sob_suspeita\\r\\nDROP TABLE IF EXISTS teste.cancel_suspeitas;\\r\\nCREATE TABLE teste.cancel_suspeitas AS\\r\\nSELECT \\r\\n    c.*,\\r\\n    s.cd_munic_na_conf,\\r\\n    s.nm_munic_na_conf,\\r\\n    s.cd_uf_na_conf,\\r\\n    s.nu_cep_na_conf,\\r\\n    s.tx_referencia_na_conf,\\r\\n    s.sn_salvou_endereco_na_conf,\\r\\n    s.sn_suspenso_dfe,\\r\\n    s.dt_suspensao_dfe AS dt_suspensao_dfe_suspeita,\\r\\n    s.cd_evento_suspensao_dfe,\\r\\n    s.qt_clientes_noteiras,\\r\\n    s.qt_fornecedoras_noteiras,\\r\\n    s.cd_situacao_suspeita,\\r\\n    s.dt_situacao_suspeita,\\r\\n    s.cd_tipo_confirmacao,\\r\\n    s.sn_cancelado_inex_inativ,\\r\\n    s.dt_inicio_protoc_cancelamento,\\r\\n    s.tx_obs_situacao_suspeita,\\r\\n    s.nu_score,\\r\\n    s.tp_variacao_score,\\r\\n    s.nu_score_ia,\\r\\n    s.tp_variacao_score_ia,\\r\\n    s.qt_motivos,\\r\\n    s.cd_usuario_responsavel,\\r\\n    s.dt_associacao_responsavel,\\r\\n    s.qt_meses_valores,\\r\\n    s.nu_per_inicial_valores,\\r\\n    s.nu_per_final_valores,\\r\\n    s.vl_total_nfes_saida,\\r\\n    s.vl_total_icms_nfes_saida,\\r\\n    s.vl_total_nfes_entrada,\\r\\n    s.vl_total_icms_nfes_entrada,\\r\\n    s.vl_total_arrecadacao_grupo,\\r\\n    s.id_setor_suspeito,\\r\\n    s.nu_per_ref_ini_vl_total_imp,\\r\\n    s.nu_per_ref_fim_vl_total_imp,\\r\\n    s.vl_total_imp_como_importador,\\r\\n    s.vl_total_imp_como_adquirente,\\r\\n    s.dt_processamento_big_data,\\r\\n    s.dt_inclusao AS dt_inclusao_suspeita,\\r\\n    s.dt_alteracao AS dt_alteracao_suspeita,\\r\\n    s.cd_usuario_alteracao,\\r\\n    s.sn_situacao_fiscal_ccc,\\r\\n    s.cd_tipo_confirmacao_anterior,\\r\\n    s.dt_confirmacao_anterior,\\r\\n    s.dt_reversao_confirmacao,\\r\\n    s.nm_fantasia_na_conf,\\r\\n    s.sn_salvou_telefones_na_conf,\\r\\n    s.nu_telefone_na_conf,\\r\\n    s.nu_telefone_corresp_na_conf\\r\\nFROM teste.cancel_cadastro c\\r\\nJOIN usr_sat_auditoria.aud_empresa_sob_suspeita s\\r\\n    ON c.cnpj = s.nu_cnpj;\", \"lastExecutedSelectionRange\": {\"start\": {\"row\": 0, \"column\": 0}, \"end\": {\"row\": 64, \"column\": 26}}, \"formatEnabled\": true, \"isFetchingData\": false, \"isCanceling\": false, \"aceAutoExpand\": false, \"lastCheckStatusRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"query_status\\\": {\\\"status\\\": \\\"available\\\"}}\", \"responseJSON\": {\"status\": 0, \"query_status\": {\"status\": \"available\"}}, \"status\": 200, \"statusText\": \"OK\"}, \"lastGetLogsRequest\": {\"readyState\": 0, \"status\": 0, \"statusText\": \"abort\"}}], \"selectedSnippet\": \"impala\", \"creatingSessionLocks\": [], \"sessions\": [], \"directoryUuid\": null, \"dependentsCoordinator\": [], \"historyFilter\": \"\", \"historyFilterVisible\": false, \"loadingHistory\": false, \"historyInitialHeight\": 13619, \"forceHistoryInitialHeight\": true, \"historyCurrentPage\": 1, \"historyTotalPages\": 140, \"schedulerViewModel\": null, \"schedulerViewModelIsLoaded\": false, \"isBatchable\": true, \"isExecutingAll\": false, \"executingAllIndex\": 0, \"retryModalConfirm\": null, \"retryModalCancel\": null, \"canSave\": true, \"unloaded\": false, \"updateHistoryFailed\": false, \"viewSchedulerId\": \"\", \"loadingScheduler\": false, \"is_history\": false, \"dialect\": \"impala\"}",
    "extra": "",
    "search": "--SELECT \r\n--    cnpj,\r\n--    cd_situacao_suspeita,\r\n--    qt_motivos,\r\n--    nu_score\r\n--FROM \r\n--    teste.cancel_suspeitas\r\n\r\n-- CriaÃ§Ã£o da tabela teste.cancel_suspeitas cruzando dados de cancel_cadastro e aud_empresa_sob_suspeita\r\nDROP TABLE IF EXISTS teste.cancel_suspeitas;\r\nCREATE TABLE teste.cancel_suspeitas AS\r\nSELECT \r\n    c.*,\r\n    s.cd_munic_na_conf,\r\n    s.nm_munic_na_conf,\r\n    s.cd_uf_na_conf,\r\n    s.nu_cep_na_conf,\r\n    s.tx_referencia_na_conf,\r\n    s.sn_salvou_endereco_na_conf,\r\n    s.sn_suspenso_dfe,\r\n    s.dt_suspensao_dfe AS dt_suspensao_dfe_suspeita,\r\n    s.cd_evento_suspensao_dfe,\r\n    s.qt_clientes_noteiras,\r\n    s.qt_fornecedoras_noteiras,\r\n    s.cd_situacao_suspeita,\r\n    s.dt_situacao_suspeita,\r\n    s.cd_tipo_confirmacao,\r\n    s.sn_cancelado_inex_inativ,\r\n    s.dt_inicio_protoc_cancelamento,\r\n    s.tx_obs_situacao_suspeita,\r\n    s.nu_score,\r\n    s.tp_variacao_score,\r\n    s.nu_score_ia,\r\n    s.tp_variacao_score_ia,\r\n    s.qt_motivos,\r\n    s.cd_usuario_responsavel,\r\n    s.dt_associacao_responsavel,\r\n    s.qt_meses_valores,\r\n    s.nu_per_inicial_valores,\r\n    s.nu_per_final_valores,\r\n    s.vl_total_nfes_saida,\r\n    s.vl_total_icms_nfes_saida,\r\n    s.vl_total_nfes_entrada,\r\n    s.vl_total_icms_nfes_entrada,\r\n    s.vl_total_arrecadacao_grupo,\r\n    s.id_setor_suspeito,\r\n    s.nu_per_ref_ini_vl_total_imp,\r\n    s.nu_per_ref_fim_vl_total_imp,\r\n    s.vl_total_imp_como_importador,\r\n    s.vl_total_imp_como_adquirente,\r\n    s.dt_processamento_big_data,\r\n    s.dt_inclusao AS dt_inclusao_suspeita,\r\n    s.dt_alteracao AS dt_alteracao_suspeita,\r\n    s.cd_usuario_alteracao,\r\n    s.sn_situacao_fiscal_ccc,\r\n    s.cd_tipo_confirmacao_anterior,\r\n    s.dt_confirmacao_anterior,\r\n    s.dt_reversao_confirmacao,\r\n    s.nm_fantasia_na_conf,\r\n    s.sn_salvou_telefones_na_conf,\r\n    s.nu_telefone_na_conf,\r\n    s.nu_telefone_corresp_na_conf\r\nFROM teste.cancel_cadastro c\r\nJOIN usr_sat_auditoria.aud_empresa_sob_suspeita s\r\n    ON c.cnpj = s.nu_cnpj;",
    "last_modified": "2025-10-15T14:59:23.970",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "4021901f-ed7a-4fd2-b5bf-8647d6b477af",
      1,
      false
    ],
    "dependencies": [
      [
        "e0e25b57-8f60-2b56-fdb0-37c9df809e45",
        1,
        false
      ]
    ]
  }
},
{
  "model": "desktop.document2",
  "pk": 115675,
  "fields": {
    "owner": [
      "tsevero"
    ],
    "name": "CANCEL: 6 SUSPEITAS_SCORE",
    "description": "",
    "uuid": "afeb9f67-7b72-6442-a3d9-2304b7b48eb7",
    "type": "query-impala",
    "connector": null,
    "data": "{\"id\": 115675, \"uuid\": \"0991ded5-c3d4-4324-9734-d06e7e4f61ef\", \"name\": \"CANCEL: 6 SUSPEITAS_SCORE\", \"description\": \"\", \"type\": \"query-impala\", \"initialType\": \"impala\", \"coordinatorUuid\": null, \"isHistory\": false, \"isManaged\": false, \"parentSavedQueryUuid\": \"afeb9f67-7b72-6442-a3d9-2304b7b48eb7\", \"isSaved\": true, \"onSuccessUrl\": null, \"pubSubUrl\": null, \"isPresentationModeDefault\": false, \"isPresentationMode\": false, \"isPresentationModeInitialized\": true, \"presentationSnippets\": {}, \"isHidingCode\": false, \"snippets\": [{\"id\": \"854197bb-ea45-ea27-5989-6bbc7e84208f\", \"name\": \"\", \"type\": \"impala\", \"connector\": {\"name\": \"Impala\", \"type\": \"impala\", \"id\": \"impala\", \"displayName\": \"Impala\", \"buttonName\": \"Consulta\", \"tooltip\": \"Impala Query\", \"optimizer\": \"off\", \"page\": \"/editor/?type=impala\", \"is_sql\": true, \"is_batchable\": true, \"dialect\": \"impala\", \"dialect_properties\": {}}, \"isSqlDialect\": true, \"dialect\": \"impala\", \"isBatchable\": true, \"autocompleteSettings\": {\"temporaryOnly\": false}, \"aceCursorPosition\": {\"row\": 4, \"column\": 13}, \"errors\": [], \"aceErrorsHolder\": [], \"aceWarningsHolder\": [], \"aceErrors\": [], \"aceWarnings\": [], \"editorMode\": true, \"dbSelectionVisible\": false, \"showExecutionAnalysis\": true, \"namespace\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"status\": \"CREATED\", \"computes\": [{\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"type\": \"direct\", \"credentials\": {}}]}, \"compute\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"namespace\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"interface\": \"impala\", \"type\": \"direct\", \"options\": {}}, \"database\": \"usr_sat_auditoria\", \"currentQueryTab\": \"queryResults\", \"pinnedContextTabs\": [], \"loadingQueries\": false, \"queriesHasErrors\": false, \"queriesCurrentPage\": 1, \"queriesTotalPages\": 3, \"queriesFilter\": \"\", \"queriesFilterVisible\": false, \"statementType\": \"text\", \"statementTypes\": [\"text\", \"file\"], \"statementPath\": \"\", \"externalStatementLoaded\": false, \"associatedDocumentLoading\": true, \"associatedDocumentUuid\": null, \"statement_raw\": \"-- Exclui a tabela de resultados, caso ela j\\u00e1 exista.\\r\\nDROP TABLE IF EXISTS teste.cancel_suspeitas_score;\\r\\n\\r\\n-- Cria a tabela de resultados SEM a coluna complexa.\\r\\nCREATE TABLE teste.cancel_suspeitas_score AS\\r\\nSELECT\\r\\n    c.cnpj,\\r\\n    ei.cd_uf,\\r\\n    ei.cd_indicio,\\r\\n    ei.nu_score AS score_indicio,\\r\\n    ei.valid_from AS dt_inicio_validade,\\r\\n    ei.valid_to AS dt_fim_validade,\\r\\n    ei.cd_atual,\\r\\n    -- A coluna ei.indicio_complemento foi removida daqui\\r\\n    ind.tx_descricao_indicio\\r\\nFROM\\r\\n    teste.cancel_cnpj c\\r\\nJOIN\\r\\n    neaf.empresa_indicio ei ON c.cnpj = ei.nu_cpf_cnpj\\r\\nJOIN\\r\\n    neaf.indicio ind ON ei.cd_indicio = ind.cd_indicio\\r\\nWHERE\\r\\n    ei.cd_atual = 1;\", \"statementsList\": [\"-- Exclui a tabela de resultados, caso ela j\\u00e1 exista.\\r\\nDROP TABLE IF EXISTS teste.cancel_suspeitas_score;\", \"\\r\\n\\r\\n-- Cria a tabela de resultados SEM a coluna complexa.\\r\\nCREATE TABLE teste.cancel_suspeitas_score AS\\r\\nSELECT\\r\\n    c.cnpj,\\r\\n    ei.cd_uf,\\r\\n    ei.cd_indicio,\\r\\n    ei.nu_score AS score_indicio,\\r\\n    ei.valid_from AS dt_inicio_validade,\\r\\n    ei.valid_to AS dt_fim_validade,\\r\\n    ei.cd_atual,\\r\\n    -- A coluna ei.indicio_complemento foi removida daqui\\r\\n    ind.tx_descricao_indicio\\r\\nFROM\\r\\n    teste.cancel_cnpj c\\r\\nJOIN\\r\\n    neaf.empresa_indicio ei ON c.cnpj = ei.nu_cpf_cnpj\\r\\nJOIN\\r\\n    neaf.indicio ind ON ei.cd_indicio = ind.cd_indicio\\r\\nWHERE\\r\\n    ei.cd_atual = 1;\"], \"aceSize\": 100, \"status\": \"available\", \"statusForButtons\": \"executed\", \"properties\": {\"settings\": []}, \"viewSettings\": {\"placeHolder\": \"Exemplo: SELECT * FROM tablename ou pressione CTRL + espa\\u00e7o\", \"sqlDialect\": true}, \"variables\": [], \"hasCurlyBracketParameters\": true, \"variableNames\": [], \"variableValues\": {}, \"statement\": \"teste.cancel_suspeitas_score\", \"result\": {\"id\": \"1f3858c2-483d-935b-811a-51fc67e60ce0\", \"type\": \"table\", \"hasResultset\": true, \"handle\": {\"secret\": \"Xc/sQCjfSyuxDKi2r362Ng==\", \"guid\": \"gE2pBIwmQVAAAAAAdfHv9g==\", \"operation_type\": 0, \"has_result_set\": true, \"modified_row_count\": null, \"log_context\": null, \"session_guid\": \"894dc9596b6f6946:ac6a72fb32d740ab\", \"session_id\": 21630, \"session_type\": \"impala\", \"statement_id\": 1, \"has_more_statements\": false, \"statements_count\": 2, \"previous_statement_hash\": \"596f2e54e15fe68786901ee0a93a664b71910c8edd719fb0783cf81f\", \"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 22, \"column\": 19}, \"statement\": \"-- Cria a tabela de resultados SEM a coluna complexa.\\nCREATE TABLE teste.cancel_suspeitas_score AS\\nSELECT\\n    c.cnpj,\\n    ei.cd_uf,\\n    ei.cd_indicio,\\n    ei.nu_score AS score_indicio,\\n    ei.valid_from AS dt_inicio_validade,\\n    ei.valid_to AS dt_fim_validade,\\n    ei.cd_atual,\\n    -- A coluna ei.indicio_complemento foi removida daqui\\n    ind.tx_descricao_indicio\\nFROM\\n    teste.cancel_cnpj c\\nJOIN\\n    neaf.empresa_indicio ei ON c.cnpj = ei.nu_cpf_cnpj\\nJOIN\\n    neaf.indicio ind ON ei.cd_indicio = ind.cd_indicio\\nWHERE\\n    ei.cd_atual = 1\"}, \"meta\": [], \"rows\": \"1\", \"hasMore\": false, \"statement_id\": 1, \"statement_range\": {\"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 22, \"column\": 19}}, \"statements_count\": 2, \"metaFilter\": {\"query\": \"\", \"facets\": {}, \"text\": []}, \"isMetaFilterVisible\": false, \"filteredMetaChecked\": true, \"filteredColumnCount\": 1, \"filteredMeta\": [{\"type\": \"int\", \"name\": \"\", \"comment\": null, \"cssClass\": \"sort-numeric\", \"checked\": true, \"originalIndex\": 0}, {\"name\": \"summary\", \"type\": \"string\", \"comment\": null, \"cssClass\": \"sort-string\", \"checked\": true, \"originalIndex\": 1}], \"fetchedOnce\": false, \"startTime\": \"2025-10-15T18:32:54.565Z\", \"endTime\": \"2025-10-15T18:32:57.072Z\", \"executionTime\": 2507, \"data\": [], \"explanation\": \"\", \"logs\": \"\", \"logLines\": 4, \"hasSomeResults\": true}, \"showGrid\": true, \"showChart\": false, \"showLogs\": true, \"progress\": 0, \"jobs\": [], \"executeNextTimeout\": 6006, \"isLoading\": false, \"resultsKlass\": \"results impala\", \"errorsKlass\": \"results impala alert alert-error\", \"is_redacted\": false, \"chartType\": \"bars\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartLimits\": [5, 10, 25, 50, 100], \"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartYMulti\": [], \"chartData\": [], \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"hideStacked\": true, \"hasDataForChart\": false, \"previousChartOptions\": {\"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"chartYMulti\": [], \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null}, \"isResultSettingsVisible\": false, \"settingsVisible\": false, \"checkStatusTimeout\": 6131, \"getLogsTimeout\": 6153, \"topRisk\": null, \"suggestion\": \"\", \"hasSuggestion\": null, \"compatibilityCheckRunning\": false, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"compatibilitySourcePlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"compatibilityTargetPlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"showSqlAnalyzer\": false, \"wasBatchExecuted\": false, \"isReady\": true, \"lastExecuted\": 1760553174312, \"lastAceSelectionRowOffset\": 0, \"executingBlockingOperation\": null, \"showLongOperationWarning\": false, \"lastExecutedStatements\": \"-- Exclui a tabela de resultados, caso ela j\\u00e1 exista.\\r\\nDROP TABLE IF EXISTS teste.cancel_suspeitas_score;\\r\\n\\r\\n-- Cria a tabela de resultados SEM a coluna complexa.\\r\\nCREATE TABLE teste.cancel_suspeitas_score AS\\r\\nSELECT\\r\\n    c.cnpj,\\r\\n    ei.cd_uf,\\r\\n    ei.cd_indicio,\\r\\n    ei.nu_score AS score_indicio,\\r\\n    ei.valid_from AS dt_inicio_validade,\\r\\n    ei.valid_to AS dt_fim_validade,\\r\\n    ei.cd_atual,\\r\\n    -- A coluna ei.indicio_complemento foi removida daqui\\r\\n    ind.tx_descricao_indicio\\r\\nFROM\\r\\n    teste.cancel_cnpj c\\r\\nJOIN\\r\\n    neaf.empresa_indicio ei ON c.cnpj = ei.nu_cpf_cnpj\\r\\nJOIN\\r\\n    neaf.indicio ind ON ei.cd_indicio = ind.cd_indicio\\r\\nWHERE\\r\\n    ei.cd_atual = 1;\", \"lastExecutedSelectionRange\": {\"start\": {\"row\": 0, \"column\": 0}, \"end\": {\"row\": 22, \"column\": 20}}, \"formatEnabled\": true, \"isFetchingData\": false, \"isCanceling\": false, \"aceAutoExpand\": false, \"lastCheckStatusRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"query_status\\\": {\\\"status\\\": \\\"available\\\"}}\", \"responseJSON\": {\"status\": 0, \"query_status\": {\"status\": \"available\"}}, \"status\": 200, \"statusText\": \"OK\"}, \"lastGetLogsRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"logs\\\": \\\"Query 5041268c04a94d80:f6eff17500000000 100% Complete (4 out of 4)\\\", \\\"progress\\\": 100, \\\"jobs\\\": [{\\\"name\\\": \\\"5041268c04a94d80:f6eff17500000000\\\", \\\"url\\\": \\\"/hue/jobbrowser#!id=5041268c04a94d80:f6eff17500000000\\\", \\\"started\\\": true, \\\"finished\\\": false, \\\"percentJob\\\": 100}], \\\"isFullLogs\\\": false}\", \"responseJSON\": {\"status\": 0, \"logs\": \"Query 5041268c04a94d80:f6eff17500000000 100% Complete (4 out of 4)\", \"progress\": 100, \"jobs\": [{\"name\": \"5041268c04a94d80:f6eff17500000000\", \"url\": \"/hue/jobbrowser#!id=5041268c04a94d80:f6eff17500000000\", \"started\": true, \"finished\": false, \"percentJob\": 100}], \"isFullLogs\": false}, \"status\": 200, \"statusText\": \"OK\"}}], \"selectedSnippet\": \"impala\", \"creatingSessionLocks\": [], \"sessions\": [], \"directoryUuid\": \"\", \"dependentsCoordinator\": [], \"historyFilter\": \"\", \"historyFilterVisible\": false, \"loadingHistory\": false, \"historyInitialHeight\": 11895, \"forceHistoryInitialHeight\": false, \"historyCurrentPage\": 1, \"historyTotalPages\": 141, \"schedulerViewModel\": null, \"schedulerViewModelIsLoaded\": false, \"isBatchable\": true, \"isExecutingAll\": false, \"executingAllIndex\": 0, \"retryModalConfirm\": null, \"retryModalCancel\": null, \"canSave\": true, \"unloaded\": false, \"updateHistoryFailed\": false, \"viewSchedulerId\": \"\", \"loadingScheduler\": false}",
    "extra": "",
    "search": "-- Exclui a tabela de resultados, caso ela jÃ¡ exista.\r\nDROP TABLE IF EXISTS teste.cancel_suspeitas_score;\r\n\r\n-- Cria a tabela de resultados SEM a coluna complexa.\r\nCREATE TABLE teste.cancel_suspeitas_score AS\r\nSELECT\r\n    c.cnpj,\r\n    ei.cd_uf,\r\n    ei.cd_indicio,\r\n    ei.nu_score AS score_indicio,\r\n    ei.valid_from AS dt_inicio_validade,\r\n    ei.valid_to AS dt_fim_validade,\r\n    ei.cd_atual,\r\n    -- A coluna ei.indicio_complemento foi removida daqui\r\n    ind.tx_descricao_indicio\r\nFROM\r\n    teste.cancel_cnpj c\r\nJOIN\r\n    neaf.empresa_indicio ei ON c.cnpj = ei.nu_cpf_cnpj\r\nJOIN\r\n    neaf.indicio ind ON ei.cd_indicio = ind.cd_indicio\r\nWHERE\r\n    ei.cd_atual = 1;",
    "last_modified": "2025-10-15T16:41:45.098",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "4021901f-ed7a-4fd2-b5bf-8647d6b477af",
      1,
      false
    ],
    "dependencies": []
  }
},
{
  "model": "desktop.document2",
  "pk": 115701,
  "fields": {
    "owner": [
      "tsevero"
    ],
    "name": "CANCEL: 7 FINAL",
    "description": "",
    "uuid": "107a6015-e404-95ed-ea46-1b6ff67f6ea9",
    "type": "query-impala",
    "connector": null,
    "data": "{\"id\": 115701, \"uuid\": \"99b2bda3-0b79-4015-b49b-5e9881cf75c7\", \"name\": \"CANCEL: 7 FINAL\", \"description\": \"\", \"type\": \"query-impala\", \"initialType\": \"impala\", \"coordinatorUuid\": null, \"isHistory\": false, \"isManaged\": false, \"parentSavedQueryUuid\": \"107a6015-e404-95ed-ea46-1b6ff67f6ea9\", \"isSaved\": true, \"onSuccessUrl\": null, \"pubSubUrl\": null, \"isPresentationModeDefault\": false, \"isPresentationMode\": false, \"isPresentationModeInitialized\": true, \"presentationSnippets\": {}, \"isHidingCode\": false, \"snippets\": [{\"id\": \"fedbdb11-34be-51bc-9b87-f58e78ae058e\", \"name\": \"\", \"type\": \"impala\", \"connector\": {\"name\": \"Impala\", \"type\": \"impala\", \"id\": \"impala\", \"displayName\": \"Impala\", \"buttonName\": \"Consulta\", \"tooltip\": \"Impala Query\", \"optimizer\": \"off\", \"page\": \"/editor/?type=impala\", \"is_sql\": true, \"is_batchable\": true, \"dialect\": \"impala\", \"dialect_properties\": {}}, \"isSqlDialect\": true, \"dialect\": \"impala\", \"isBatchable\": true, \"autocompleteSettings\": {\"temporaryOnly\": false}, \"aceCursorPosition\": {\"row\": 76, \"column\": 30}, \"errors\": [], \"aceErrorsHolder\": [], \"aceWarningsHolder\": [], \"aceErrors\": [], \"aceWarnings\": [], \"editorMode\": true, \"dbSelectionVisible\": false, \"showExecutionAnalysis\": true, \"namespace\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"status\": \"CREATED\", \"computes\": [{\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"type\": \"direct\", \"credentials\": {}}]}, \"compute\": {\"id\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"name\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"namespace\": \"8271bb54-0cd9-47e1-89f2-a8a5de91d943\", \"interface\": \"impala\", \"type\": \"direct\", \"options\": {}}, \"database\": \"usr_sat_ods\", \"currentQueryTab\": \"queryResults\", \"pinnedContextTabs\": [], \"loadingQueries\": false, \"queriesHasErrors\": false, \"queriesCurrentPage\": 1, \"queriesTotalPages\": 1, \"queriesFilter\": \"\", \"queriesFilterVisible\": false, \"statementType\": \"text\", \"statementTypes\": [\"text\", \"file\"], \"statementPath\": \"\", \"externalStatementLoaded\": false, \"associatedDocumentLoading\": true, \"associatedDocumentUuid\": null, \"statement_raw\": \"-- Remover a tabela final se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_final;\\r\\n\\r\\n-- Criar a nova tabela consolidada\\r\\nCREATE TABLE teste.cancel_final AS\\r\\nSELECT \\r\\n    -- Colunas de identifica\\u00e7\\u00e3o b\\u00e1sica\\r\\n    base.cnpj,\\r\\n   --base.malhas,\\r\\n    \\r\\n    -- Dados de cadastro utilizados no Python\\r\\n    cad.nm_razao_social,\\r\\n    cad.nm_sit_cadastral,\\r\\n    cad.nm_reg_apuracao,\\r\\n    cad.cd_cnae,\\r\\n    cad.cd_cnae1,\\r\\n    cad.cd_cnae2,\\r\\n    cad.cd_cnae3,\\r\\n    cad.tx_outras_cnaes,\\r\\n    cad.sn_simples_nacional_rfb,\\r\\n    \\r\\n    -- Dados de declara\\u00e7\\u00f5es normais (DIME)\\r\\n    n.nm_reg_apuracao AS regime_normal,\\r\\n    n.periodos_omissos AS periodos_omissos_normal,\\r\\n    n.periodos_zerados AS periodos_zerados_normal,\\r\\n    n.total_periodos AS total_periodos_normal,\\r\\n    n.periodos_declarados AS periodos_declarados_normal,\\r\\n    \\r\\n    -- Dados de declara\\u00e7\\u00f5es do Simples Nacional (PGDAS-D)\\r\\n    s.nm_reg_apuracao AS regime_simples,\\r\\n    s.periodos_omissos AS periodos_omissos_simples,\\r\\n    s.periodos_zerados AS periodos_zerados_simples,\\r\\n    s.total_periodos AS total_periodos_simples,\\r\\n    s.periodos_declarados AS periodos_declarados_simples,\\r\\n    \\r\\n    -- Dados de recolhimentos (pagamentos)\\r\\n    rec.quantidade_pagtos,\\r\\n    rec.valor_pagtos,\\r\\n    \\r\\n    -- Dados de suspeitas do score (AGREGADOS)\\r\\n    score_agg.qt_indicios,\\r\\n    \\r\\n    -- Dados de NFes\\r\\n    COALESCE(n.total_nfes_emitidas, s.total_nfes_emitidas, 0) AS total_nfes_emitidas,\\r\\n    nfr.total_nfes_recebidas\\r\\n    \\r\\nFROM teste.cancel_cnpj base\\r\\nLEFT JOIN teste.cancel_cadastro cad \\r\\n    ON base.cnpj = cad.cnpj\\r\\nLEFT JOIN teste.cancel_zero_normal n \\r\\n    ON base.cnpj = n.cnpj_base\\r\\nLEFT JOIN teste.cancel_zero_simples s \\r\\n    ON base.cnpj = s.cnpj_base\\r\\nLEFT JOIN teste.cancel_recolhimento rec \\r\\n    ON base.cnpj = rec.cnpj\\r\\n    \\r\\n-- Dados agregados de suspeitas, para evitar multiplica\\u00e7\\u00e3o de linhas\\r\\nLEFT JOIN (\\r\\n    SELECT \\r\\n        cnpj,\\r\\n        MAX(qt_indicios) AS qt_indicios\\r\\n    FROM teste.cancel_suspeitas_score\\r\\n    GROUP BY cnpj\\r\\n) score_agg ON base.cnpj = score_agg.cnpj\\r\\n\\r\\nLEFT JOIN (\\r\\n    -- Subquery para obter os dados de NFes recebidas\\r\\n    SELECT \\r\\n        cb.cnpj,\\r\\n        COUNT(DISTINCT chave) AS total_nfes_recebidas\\r\\n    FROM teste.cancel_cnpj cb\\r\\n    LEFT JOIN nfe.nfe n ON \\r\\n        REGEXP_REPLACE(TRIM(CAST(n.procnfe.nfe.infnfe.dest.cnpj AS STRING)), '[^0-9]', '') = \\r\\n        REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n    WHERE (n.ano_emissao * 100 + n.mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    GROUP BY cb.cnpj\\r\\n) nfr ON base.cnpj = nfr.cnpj;\", \"statementsList\": [\"-- Remover a tabela final se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_final;\", \"\\r\\n\\r\\n-- Criar a nova tabela consolidada\\r\\nCREATE TABLE teste.cancel_final AS\\r\\nSELECT \\r\\n    -- Colunas de identifica\\u00e7\\u00e3o b\\u00e1sica\\r\\n    base.cnpj,\\r\\n   --base.malhas,\\r\\n    \\r\\n    -- Dados de cadastro utilizados no Python\\r\\n    cad.nm_razao_social,\\r\\n    cad.nm_sit_cadastral,\\r\\n    cad.nm_reg_apuracao,\\r\\n    cad.cd_cnae,\\r\\n    cad.cd_cnae1,\\r\\n    cad.cd_cnae2,\\r\\n    cad.cd_cnae3,\\r\\n    cad.tx_outras_cnaes,\\r\\n    cad.sn_simples_nacional_rfb,\\r\\n    \\r\\n    -- Dados de declara\\u00e7\\u00f5es normais (DIME)\\r\\n    n.nm_reg_apuracao AS regime_normal,\\r\\n    n.periodos_omissos AS periodos_omissos_normal,\\r\\n    n.periodos_zerados AS periodos_zerados_normal,\\r\\n    n.total_periodos AS total_periodos_normal,\\r\\n    n.periodos_declarados AS periodos_declarados_normal,\\r\\n    \\r\\n    -- Dados de declara\\u00e7\\u00f5es do Simples Nacional (PGDAS-D)\\r\\n    s.nm_reg_apuracao AS regime_simples,\\r\\n    s.periodos_omissos AS periodos_omissos_simples,\\r\\n    s.periodos_zerados AS periodos_zerados_simples,\\r\\n    s.total_periodos AS total_periodos_simples,\\r\\n    s.periodos_declarados AS periodos_declarados_simples,\\r\\n    \\r\\n    -- Dados de recolhimentos (pagamentos)\\r\\n    rec.quantidade_pagtos,\\r\\n    rec.valor_pagtos,\\r\\n    \\r\\n    -- Dados de suspeitas do score (AGREGADOS)\\r\\n    score_agg.qt_indicios,\\r\\n    \\r\\n    -- Dados de NFes\\r\\n    COALESCE(n.total_nfes_emitidas, s.total_nfes_emitidas, 0) AS total_nfes_emitidas,\\r\\n    nfr.total_nfes_recebidas\\r\\n    \\r\\nFROM teste.cancel_cnpj base\\r\\nLEFT JOIN teste.cancel_cadastro cad \\r\\n    ON base.cnpj = cad.cnpj\\r\\nLEFT JOIN teste.cancel_zero_normal n \\r\\n    ON base.cnpj = n.cnpj_base\\r\\nLEFT JOIN teste.cancel_zero_simples s \\r\\n    ON base.cnpj = s.cnpj_base\\r\\nLEFT JOIN teste.cancel_recolhimento rec \\r\\n    ON base.cnpj = rec.cnpj\\r\\n    \\r\\n-- Dados agregados de suspeitas, para evitar multiplica\\u00e7\\u00e3o de linhas\\r\\nLEFT JOIN (\\r\\n    SELECT \\r\\n        cnpj,\\r\\n        MAX(qt_indicios) AS qt_indicios\\r\\n    FROM teste.cancel_suspeitas_score\\r\\n    GROUP BY cnpj\\r\\n) score_agg ON base.cnpj = score_agg.cnpj\\r\\n\\r\\nLEFT JOIN (\\r\\n    -- Subquery para obter os dados de NFes recebidas\\r\\n    SELECT \\r\\n        cb.cnpj,\\r\\n        COUNT(DISTINCT chave) AS total_nfes_recebidas\\r\\n    FROM teste.cancel_cnpj cb\\r\\n    LEFT JOIN nfe.nfe n ON \\r\\n        REGEXP_REPLACE(TRIM(CAST(n.procnfe.nfe.infnfe.dest.cnpj AS STRING)), '[^0-9]', '') = \\r\\n        REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n    WHERE (n.ano_emissao * 100 + n.mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    GROUP BY cb.cnpj\\r\\n) nfr ON base.cnpj = nfr.cnpj;\"], \"aceSize\": 100, \"status\": \"available\", \"statusForButtons\": \"executed\", \"properties\": {\"settings\": []}, \"viewSettings\": {\"placeHolder\": \"Exemplo: SELECT * FROM tablename ou pressione CTRL + espa\\u00e7o\", \"sqlDialect\": true}, \"variables\": [], \"hasCurlyBracketParameters\": true, \"variableNames\": [], \"variableValues\": {}, \"statement\": \"-- Remover a tabela final se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_final;\\r\\n\\r\\n-- Criar a nova tabela consolidada\\r\\nCREATE TABLE teste.cancel_final AS\\r\\nSELECT \\r\\n    -- Colunas de identifica\\u00e7\\u00e3o b\\u00e1sica\\r\\n    base.cnpj,\\r\\n   --base.malhas,\\r\\n    \\r\\n    -- Dados de cadastro utilizados no Python\\r\\n    cad.nm_razao_social,\\r\\n    cad.nm_sit_cadastral,\\r\\n    cad.nm_reg_apuracao,\\r\\n    cad.cd_cnae,\\r\\n    cad.cd_cnae1,\\r\\n    cad.cd_cnae2,\\r\\n    cad.cd_cnae3,\\r\\n    cad.tx_outras_cnaes,\\r\\n    cad.sn_simples_nacional_rfb,\\r\\n    \\r\\n    -- Dados de declara\\u00e7\\u00f5es normais (DIME)\\r\\n    n.nm_reg_apuracao AS regime_normal,\\r\\n    n.periodos_omissos AS periodos_omissos_normal,\\r\\n    n.periodos_zerados AS periodos_zerados_normal,\\r\\n    n.total_periodos AS total_periodos_normal,\\r\\n    n.periodos_declarados AS periodos_declarados_normal,\\r\\n    \\r\\n    -- Dados de declara\\u00e7\\u00f5es do Simples Nacional (PGDAS-D)\\r\\n    s.nm_reg_apuracao AS regime_simples,\\r\\n    s.periodos_omissos AS periodos_omissos_simples,\\r\\n    s.periodos_zerados AS periodos_zerados_simples,\\r\\n    s.total_periodos AS total_periodos_simples,\\r\\n    s.periodos_declarados AS periodos_declarados_simples,\\r\\n    \\r\\n    -- Dados de recolhimentos (pagamentos)\\r\\n    rec.quantidade_pagtos,\\r\\n    rec.valor_pagtos,\\r\\n    \\r\\n    -- Dados de suspeitas do score (AGREGADOS)\\r\\n    score_agg.qt_indicios,\\r\\n    \\r\\n    -- Dados de NFes\\r\\n    COALESCE(n.total_nfes_emitidas, s.total_nfes_emitidas, 0) AS total_nfes_emitidas,\\r\\n    nfr.total_nfes_recebidas\\r\\n    \\r\\nFROM teste.cancel_cnpj base\\r\\nLEFT JOIN teste.cancel_cadastro cad \\r\\n    ON base.cnpj = cad.cnpj\\r\\nLEFT JOIN teste.cancel_zero_normal n \\r\\n    ON base.cnpj = n.cnpj_base\\r\\nLEFT JOIN teste.cancel_zero_simples s \\r\\n    ON base.cnpj = s.cnpj_base\\r\\nLEFT JOIN teste.cancel_recolhimento rec \\r\\n    ON base.cnpj = rec.cnpj\\r\\n    \\r\\n-- Dados agregados de suspeitas, para evitar multiplica\\u00e7\\u00e3o de linhas\\r\\nLEFT JOIN (\\r\\n    SELECT \\r\\n        cnpj,\\r\\n        MAX(qt_indicios) AS qt_indicios\\r\\n    FROM teste.cancel_suspeitas_score\\r\\n    GROUP BY cnpj\\r\\n) score_agg ON base.cnpj = score_agg.cnpj\\r\\n\\r\\nLEFT JOIN (\\r\\n    -- Subquery para obter os dados de NFes recebidas\\r\\n    SELECT \\r\\n        cb.cnpj,\\r\\n        COUNT(DISTINCT chave) AS total_nfes_recebidas\\r\\n    FROM teste.cancel_cnpj cb\\r\\n    LEFT JOIN nfe.nfe n ON \\r\\n        REGEXP_REPLACE(TRIM(CAST(n.procnfe.nfe.infnfe.dest.cnpj AS STRING)), '[^0-9]', '') = \\r\\n        REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n    WHERE (n.ano_emissao * 100 + n.mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    GROUP BY cb.cnpj\\r\\n) nfr ON base.cnpj = nfr.cnpj;\", \"result\": {\"id\": \"d424aba7-0691-2be1-2cb8-e40b8eb44e31\", \"type\": \"table\", \"hasResultset\": true, \"handle\": {\"secret\": \"aZze3cJWTpuAL4u06/eikg==\", \"guid\": \"NS6zBYHeQFYAAAAAGdq02w==\", \"operation_type\": 0, \"has_result_set\": true, \"modified_row_count\": null, \"log_context\": null, \"session_guid\": \"984b6f311745cffa:2ddd378c7babe5a5\", \"session_id\": 14429, \"session_type\": \"impala\", \"statement_id\": 1, \"has_more_statements\": false, \"statements_count\": 2, \"previous_statement_hash\": \"49829dfb4fd4da78bbc1f0f39e6891cc111642553f65f8a20d449f36\", \"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 76, \"column\": 29}, \"statement\": \"-- Criar a nova tabela consolidada\\nCREATE TABLE teste.cancel_final AS\\nSELECT \\n    -- Colunas de identifica\\u00e7\\u00e3o b\\u00e1sica\\n    base.cnpj,\\n   --base.malhas,\\n    \\n    -- Dados de cadastro utilizados no Python\\n    cad.nm_razao_social,\\n    cad.nm_sit_cadastral,\\n    cad.nm_reg_apuracao,\\n    cad.cd_cnae,\\n    cad.cd_cnae1,\\n    cad.cd_cnae2,\\n    cad.cd_cnae3,\\n    cad.tx_outras_cnaes,\\n    cad.sn_simples_nacional_rfb,\\n    \\n    -- Dados de declara\\u00e7\\u00f5es normais (DIME)\\n    n.nm_reg_apuracao AS regime_normal,\\n    n.periodos_omissos AS periodos_omissos_normal,\\n    n.periodos_zerados AS periodos_zerados_normal,\\n    n.total_periodos AS total_periodos_normal,\\n    n.periodos_declarados AS periodos_declarados_normal,\\n    \\n    -- Dados de declara\\u00e7\\u00f5es do Simples Nacional (PGDAS-D)\\n    s.nm_reg_apuracao AS regime_simples,\\n    s.periodos_omissos AS periodos_omissos_simples,\\n    s.periodos_zerados AS periodos_zerados_simples,\\n    s.total_periodos AS total_periodos_simples,\\n    s.periodos_declarados AS periodos_declarados_simples,\\n    \\n    -- Dados de recolhimentos (pagamentos)\\n    rec.quantidade_pagtos,\\n    rec.valor_pagtos,\\n    \\n    -- Dados de suspeitas do score (AGREGADOS)\\n    score_agg.qt_indicios,\\n    \\n    -- Dados de NFes\\n    COALESCE(n.total_nfes_emitidas, s.total_nfes_emitidas, 0) AS total_nfes_emitidas,\\n    nfr.total_nfes_recebidas\\n    \\nFROM teste.cancel_cnpj base\\nLEFT JOIN teste.cancel_cadastro cad \\n    ON base.cnpj = cad.cnpj\\nLEFT JOIN teste.cancel_zero_normal n \\n    ON base.cnpj = n.cnpj_base\\nLEFT JOIN teste.cancel_zero_simples s \\n    ON base.cnpj = s.cnpj_base\\nLEFT JOIN teste.cancel_recolhimento rec \\n    ON base.cnpj = rec.cnpj\\n    \\n-- Dados agregados de suspeitas, para evitar multiplica\\u00e7\\u00e3o de linhas\\nLEFT JOIN (\\n    SELECT \\n        cnpj,\\n        MAX(qt_indicios) AS qt_indicios\\n    FROM teste.cancel_suspeitas_score\\n    GROUP BY cnpj\\n) score_agg ON base.cnpj = score_agg.cnpj\\n\\nLEFT JOIN (\\n    -- Subquery para obter os dados de NFes recebidas\\n    SELECT \\n        cb.cnpj,\\n        COUNT(DISTINCT chave) AS total_nfes_recebidas\\n    FROM teste.cancel_cnpj cb\\n    LEFT JOIN nfe.nfe n ON \\n        REGEXP_REPLACE(TRIM(CAST(n.procnfe.nfe.infnfe.dest.cnpj AS STRING)), '[^0-9]', '') = \\n        REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\n    WHERE (n.ano_emissao * 100 + n.mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\n    GROUP BY cb.cnpj\\n) nfr ON base.cnpj = nfr.cnpj\"}, \"meta\": [], \"rows\": \"1\", \"hasMore\": false, \"statement_id\": 1, \"statement_range\": {\"start\": {\"row\": 3, \"column\": 0}, \"end\": {\"row\": 76, \"column\": 29}}, \"statements_count\": 2, \"metaFilter\": {\"query\": \"\", \"facets\": {}, \"text\": []}, \"isMetaFilterVisible\": false, \"filteredMetaChecked\": true, \"filteredColumnCount\": 1, \"filteredMeta\": [{\"type\": \"int\", \"name\": \"\", \"comment\": null, \"cssClass\": \"sort-numeric\", \"checked\": true, \"originalIndex\": 0}, {\"name\": \"summary\", \"type\": \"string\", \"comment\": null, \"cssClass\": \"sort-string\", \"checked\": true, \"originalIndex\": 1}], \"fetchedOnce\": false, \"startTime\": \"2025-04-10T18:22:37.218Z\", \"endTime\": \"2025-04-10T18:23:28.113Z\", \"executionTime\": 50895, \"data\": [], \"explanation\": \"\", \"logs\": \"\", \"logLines\": 36, \"hasSomeResults\": true}, \"showGrid\": true, \"showChart\": false, \"showLogs\": true, \"progress\": 0, \"jobs\": [], \"executeNextTimeout\": 3866, \"isLoading\": false, \"resultsKlass\": \"results impala\", \"errorsKlass\": \"results impala alert alert-error\", \"is_redacted\": false, \"chartType\": \"bars\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartLimits\": [5, 10, 25, 50, 100], \"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartYMulti\": [], \"chartData\": [], \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"hideStacked\": true, \"hasDataForChart\": false, \"previousChartOptions\": {\"chartLimit\": null, \"chartX\": \"summary\", \"chartXPivot\": null, \"chartYSingle\": null, \"chartMapType\": \"marker\", \"chartMapLabel\": null, \"chartMapHeat\": null, \"chartYMulti\": [], \"chartScope\": \"world\", \"chartTimelineType\": \"bar\", \"chartSorting\": \"none\", \"chartScatterGroup\": null, \"chartScatterSize\": null}, \"isResultSettingsVisible\": false, \"settingsVisible\": false, \"checkStatusTimeout\": 5092, \"getLogsTimeout\": 5169, \"topRisk\": null, \"suggestion\": \"\", \"hasSuggestion\": null, \"compatibilityCheckRunning\": false, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"compatibilitySourcePlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"compatibilityTargetPlatform\": {\"name\": \"Impala\", \"value\": \"impala\"}, \"showSqlAnalyzer\": false, \"wasBatchExecuted\": false, \"isReady\": true, \"lastExecuted\": 1744309356919, \"lastAceSelectionRowOffset\": 0, \"executingBlockingOperation\": null, \"showLongOperationWarning\": false, \"lastExecutedStatements\": \"-- Remover a tabela final se existir\\r\\nDROP TABLE IF EXISTS teste.cancel_final;\\r\\n\\r\\n-- Criar a nova tabela consolidada\\r\\nCREATE TABLE teste.cancel_final AS\\r\\nSELECT \\r\\n    -- Colunas de identifica\\u00e7\\u00e3o b\\u00e1sica\\r\\n    base.cnpj,\\r\\n   --base.malhas,\\r\\n    \\r\\n    -- Dados de cadastro utilizados no Python\\r\\n    cad.nm_razao_social,\\r\\n    cad.nm_sit_cadastral,\\r\\n    cad.nm_reg_apuracao,\\r\\n    cad.cd_cnae,\\r\\n    cad.cd_cnae1,\\r\\n    cad.cd_cnae2,\\r\\n    cad.cd_cnae3,\\r\\n    cad.tx_outras_cnaes,\\r\\n    cad.sn_simples_nacional_rfb,\\r\\n    \\r\\n    -- Dados de declara\\u00e7\\u00f5es normais (DIME)\\r\\n    n.nm_reg_apuracao AS regime_normal,\\r\\n    n.periodos_omissos AS periodos_omissos_normal,\\r\\n    n.periodos_zerados AS periodos_zerados_normal,\\r\\n    n.total_periodos AS total_periodos_normal,\\r\\n    n.periodos_declarados AS periodos_declarados_normal,\\r\\n    \\r\\n    -- Dados de declara\\u00e7\\u00f5es do Simples Nacional (PGDAS-D)\\r\\n    s.nm_reg_apuracao AS regime_simples,\\r\\n    s.periodos_omissos AS periodos_omissos_simples,\\r\\n    s.periodos_zerados AS periodos_zerados_simples,\\r\\n    s.total_periodos AS total_periodos_simples,\\r\\n    s.periodos_declarados AS periodos_declarados_simples,\\r\\n    \\r\\n    -- Dados de recolhimentos (pagamentos)\\r\\n    rec.quantidade_pagtos,\\r\\n    rec.valor_pagtos,\\r\\n    \\r\\n    -- Dados de suspeitas do score (AGREGADOS)\\r\\n    score_agg.qt_indicios,\\r\\n    \\r\\n    -- Dados de NFes\\r\\n    COALESCE(n.total_nfes_emitidas, s.total_nfes_emitidas, 0) AS total_nfes_emitidas,\\r\\n    nfr.total_nfes_recebidas\\r\\n    \\r\\nFROM teste.cancel_cnpj base\\r\\nLEFT JOIN teste.cancel_cadastro cad \\r\\n    ON base.cnpj = cad.cnpj\\r\\nLEFT JOIN teste.cancel_zero_normal n \\r\\n    ON base.cnpj = n.cnpj_base\\r\\nLEFT JOIN teste.cancel_zero_simples s \\r\\n    ON base.cnpj = s.cnpj_base\\r\\nLEFT JOIN teste.cancel_recolhimento rec \\r\\n    ON base.cnpj = rec.cnpj\\r\\n    \\r\\n-- Dados agregados de suspeitas, para evitar multiplica\\u00e7\\u00e3o de linhas\\r\\nLEFT JOIN (\\r\\n    SELECT \\r\\n        cnpj,\\r\\n        MAX(qt_indicios) AS qt_indicios\\r\\n    FROM teste.cancel_suspeitas_score\\r\\n    GROUP BY cnpj\\r\\n) score_agg ON base.cnpj = score_agg.cnpj\\r\\n\\r\\nLEFT JOIN (\\r\\n    -- Subquery para obter os dados de NFes recebidas\\r\\n    SELECT \\r\\n        cb.cnpj,\\r\\n        COUNT(DISTINCT chave) AS total_nfes_recebidas\\r\\n    FROM teste.cancel_cnpj cb\\r\\n    LEFT JOIN nfe.nfe n ON \\r\\n        REGEXP_REPLACE(TRIM(CAST(n.procnfe.nfe.infnfe.dest.cnpj AS STRING)), '[^0-9]', '') = \\r\\n        REGEXP_REPLACE(TRIM(CAST(cb.cnpj AS STRING)), '[^0-9]', '')\\r\\n    WHERE (n.ano_emissao * 100 + n.mes_emissao) IN (202502,202501,202412,202411,202410,202409,202408,202407)\\r\\n    GROUP BY cb.cnpj\\r\\n) nfr ON base.cnpj = nfr.cnpj;\", \"lastExecutedSelectionRange\": {\"start\": {\"row\": 0, \"column\": 0}, \"end\": {\"row\": 76, \"column\": 30}}, \"formatEnabled\": true, \"isFetchingData\": false, \"isCanceling\": false, \"aceAutoExpand\": false, \"lastCheckStatusRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"query_status\\\": {\\\"status\\\": \\\"available\\\"}}\", \"responseJSON\": {\"status\": 0, \"query_status\": {\"status\": \"available\"}}, \"status\": 200, \"statusText\": \"OK\"}, \"lastGetLogsRequest\": {\"readyState\": 4, \"responseText\": \"{\\\"status\\\": 0, \\\"logs\\\": \\\"Query 5640de8105b32e35:dbb4da1900000000 100% Complete (3855 out of 3855)\\\", \\\"progress\\\": 100, \\\"jobs\\\": [{\\\"name\\\": \\\"5640de8105b32e35:dbb4da1900000000\\\", \\\"url\\\": \\\"/hue/jobbrowser#!id=5640de8105b32e35:dbb4da1900000000\\\", \\\"started\\\": true, \\\"finished\\\": false, \\\"percentJob\\\": 100}], \\\"isFullLogs\\\": false}\", \"responseJSON\": {\"status\": 0, \"logs\": \"Query 5640de8105b32e35:dbb4da1900000000 100% Complete (3855 out of 3855)\", \"progress\": 100, \"jobs\": [{\"name\": \"5640de8105b32e35:dbb4da1900000000\", \"url\": \"/hue/jobbrowser#!id=5640de8105b32e35:dbb4da1900000000\", \"started\": true, \"finished\": false, \"percentJob\": 100}], \"isFullLogs\": false}, \"status\": 200, \"statusText\": \"OK\"}}], \"selectedSnippet\": \"impala\", \"creatingSessionLocks\": [], \"sessions\": [], \"directoryUuid\": \"\", \"dependentsCoordinator\": [], \"historyFilter\": \"\", \"historyFilterVisible\": false, \"loadingHistory\": false, \"historyInitialHeight\": 17859, \"forceHistoryInitialHeight\": false, \"historyCurrentPage\": 1, \"historyTotalPages\": 27, \"schedulerViewModel\": null, \"schedulerViewModelIsLoaded\": false, \"isBatchable\": true, \"isExecutingAll\": false, \"executingAllIndex\": 0, \"retryModalConfirm\": null, \"retryModalCancel\": null, \"canSave\": true, \"unloaded\": false, \"updateHistoryFailed\": false, \"viewSchedulerId\": \"\", \"loadingScheduler\": false, \"is_history\": false}",
    "extra": "",
    "search": "-- Remover a tabela final se existir\r\nDROP TABLE IF EXISTS teste.cancel_final;\r\n\r\n-- Criar a nova tabela consolidada\r\nCREATE TABLE teste.cancel_final AS\r\nSELECT \r\n    -- Colunas de identificaÃ§Ã£o bÃ¡sica\r\n    base.cnpj,\r\n   --base.malhas,\r\n    \r\n    -- Dados de cadastro utilizados no Python\r\n    cad.nm_razao_social,\r\n    cad.nm_sit_cadastral,\r\n    cad.nm_reg_apuracao,\r\n    cad.cd_cnae,\r\n    cad.cd_cnae1,\r\n    cad.cd_cnae2,\r\n    cad.cd_cnae3,\r\n    cad.tx_outras_cnaes,\r\n    cad.sn_simples_nacional_rfb,\r\n    \r\n    -- Dados de declaraÃ§Ãµes normais (DIME)\r\n    n.nm_reg_apuracao AS regime_normal,\r\n    n.periodos_omissos AS periodos_omissos_normal,\r\n    n.periodos_zerados AS periodos_zerados_normal,\r\n    n.total_periodos AS total_periodos_normal,\r\n    n.periodos_declarados AS periodos_declarados_normal,\r\n    \r\n    -- Dados de declaraÃ§Ãµes do Simples Nacional (PGDAS-D)\r\n    s.nm_reg_apuracao AS regime_simples,\r\n    s.periodos_omissos AS periodos_omissos_simples,\r\n    s.periodos_zerados AS periodos_zerados_simples,\r\n    s.total_periodos AS total_periodos_simples,\r\n    s.periodos_declarados AS periodos_declarados_simples,\r\n    \r\n    -- Dados de recolhimentos (pagamentos)\r\n    rec.quantidade_pagtos,\r\n    rec.valor_pagtos,\r\n    \r\n    -- Dados de suspeitas do score (AGREGADOS)\r\n    score_agg.qt_indicios,\r\n    \r\n    -- Dados de NFes\r\n    COALESCE(n.total_nfes_emitidas, s.total_nfes_emitidas, 0) AS total_nfes_emitidas,\r\n    nfr.total_nfes_recebidas\r\n    \r\nFROM teste.cancel_cnpj base\r\nLEFT JOIN teste.cancel_cadastro cad \r\n    ON base.cnpj = cad.cnpj\r\nLEFT JOIN teste.cancel_zero_normal n \r\n    ON base.cnpj = n.cnpj_base\r\nLEFT JOIN teste.cancel_zero_simples s \r\n    ON base.cnpj = s.cnpj_base\r\nLEFT JOIN teste.cancel_recolhimento rec \r\n    ON base.cnpj = rec.cnpj\r\n    \r\n-- Dados agregados de suspeitas, para evitar multiplicaÃ§Ã£o de linhas\r\nLEFT JOIN (\r\n    SELECT \r\n        cnpj,\r\n        MAX(qt_indicios) AS qt_indicios\r\n    FROM teste.cancel_suspeitas_score\r\n    GROUP BY cnpj\r\n) score_agg O",
    "last_modified": "2025-04-10T15:23:51.769",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "4021901f-ed7a-4fd2-b5bf-8647d6b477af",
      1,
      false
    ],
    "dependencies": []
  }
},
{
  "model": "desktop.document2",
  "pk": 122423,
  "fields": {
    "owner": [
      "tsevero"
    ],
    "name": "CANCEL",
    "description": "",
    "uuid": "4021901f-ed7a-4fd2-b5bf-8647d6b477af",
    "type": "directory",
    "connector": null,
    "data": "{}",
    "extra": "",
    "search": null,
    "last_modified": "2025-05-13T14:12:32.834",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "a8280168-7cf2-40b1-bc5d-733014ae6ba9",
      1,
      false
    ],
    "dependencies": []
  }
}
]
